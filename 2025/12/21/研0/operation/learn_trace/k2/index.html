<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="汤汁小白菜">
    <meta name="description" content="
0.1. 第一阶段：环境搭建与认知重构（第1-3天）
0.1.1. 第一天：理解”优化”本质与工具链定位
0.1.1.1. 上午（2小时）：概念认知重塑
1.1 什么是优化问题？（从生活实例讲起）
想象你在超市购物，手里有200">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>汤汁小白菜</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">汤汁小白菜</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">

      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
      <i class="fas fa-chevron-down" aria-hidden="true" style="zoom: 0.6;"></i>
    </a>
    <ul class="sub-nav menus_item_child ">
      
      <li>
        <a href="/resume">
          
          <i class="fas fa-user-circle" style="margin-top: -20px; zoom: 0.6;"></i>
          
          <span>resume</span>
        </a>
      </li>
      
    </ul>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">汤汁小白菜</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="javascript:;">
			
				<i class="fa-fw fas fa-user-circle"></i>
			
			关于
			<span class="m-icon"><i class="fas fa-chevron-right"></i></span>
		</a>
            <ul  style="background:  ;" >
              
                <li>

                  <a href="/resume " style="margin-left:75px">
				  
				   <i class="fa fas fa-user-circle" style="position: absolute;left:50px" ></i>
			      
		          <span>resume</span>
                  </a>
                </li>
              
            </ul>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title"></h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2025-12-21
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2025-12-23
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    18.3k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    85 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <hr>
<h2 id="第一阶段环境搭建与认知重构第1-3天">0.1. 第一阶段：环境搭建与认知重构（第1-3天）</h2>
<h3 id="第一天理解优化本质与工具链定位">0.1.1. 第一天：理解”优化”本质与工具链定位</h3>
<h4 id="上午2小时概念认知重塑">0.1.1.1. 上午（2小时）：概念认知重塑</h4>
<p><strong>1.1 什么是优化问题？（从生活实例讲起）</strong></p>
<p>想象你在超市购物，手里有200元预算，要买10种商品。每种商品有： -
价格（成本） - 营养价值（收益） - 保质期（约束条件）</p>
<p>目标：在预算内买到营养最高的组合，且每种商品至少买1件。</p>
<p><strong>这就是优化问题的三要素：</strong> -
<strong>决策变量</strong>：每种商品买多少（x₁, x₂, …, x₁₀） -
<strong>目标函数</strong>：最大化营养价值（或最小化成本） -
<strong>约束条件</strong>：总预算≤200元，每种商品≥1件</p>
<pre class="line-numbers language-wolfram" data-language="wolfram"><code class="language-wolfram">数学表达：
maximize: Σ(营养值ᵢ × xᵢ)
subject to: Σ(价格ᵢ × xᵢ) ≤ 200
            xᵢ ≥ 1, ∀i ∈ &#123;1,2,...,10&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>优化求解器（Gurobi）的作用就是：<strong>自动帮你找到满足所有条件的最优解，而不是让你穷举所有可能组合</strong>。</p>
<p><strong>1.2 工具链角色分工（保姆级比喻）</strong></p>
<pre class="line-numbers language-none"><code class="language-none">┌─────────────────────────────────────────────────────────┐
│                    你的办公桌 (MATLAB)                  │
│                                                          │
│  ┌──────────────┐       ┌──────────────┐               │
│  │   秘书小姐   │◄─────►│   数学苦力   │               │
│  │   (YALMIP)   │ 翻译  │   (Gurobi)   │               │
│  └──────────────┘       └──────────────┘               │
└─────────────────────────────────────────────────────────┘<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li><strong>MATLAB</strong>：你的”操作系统”。所有操作都在这里完成，负责数据预处理、结果可视化、脚本管理</li>
<li><strong>YALMIP</strong>：你的”智能翻译秘书”。她懂数学语言（≤, ≥,
Σ），会把你的数学公式翻译成Gurobi能听懂的机器语言</li>
<li><strong>Gurobi</strong>：你的”超级计算苦力”。他只做一件事：快速解方程，但需要你告诉他方程长什么样</li>
</ul>
<p><strong>关键认知</strong>：<strong>千万不要跳过YALMIP直接学Gurobi！</strong>
就像你不会为了学英语直接去读莎士比亚原著，而是应该先学语法。YALMIP就是那个”语法老师”。</p>
<h4 id="下午3小时软件安装实战">0.1.1.2. 下午（3小时）：软件安装实战</h4>
<p><strong>1.3 MATLAB安装与基础配置</strong></p>
<pre class="line-numbers language-none"><code class="language-none">【安装步骤】
1. 获取安装包：
   - 学校版：通过学校软件中心，使用校园邮箱注册MathWorks账号
   - 试用版：官网下载R2024a&#x2F;R2024b（30天试用）
   - 注意：建议使用R2021b及以上版本，对YALMIP兼容性最好

2. 安装注意事项：
   - 勾选&quot;MATLAB Compiler&quot;和&quot;Optimization Toolbox&quot;（虽然我们用Gurobi，但这两个工具箱有时辅助用）
   - 安装路径不要有中文和空格，例如：D:\MATLAB\R2024b
   - 安装后首次启动，选择&quot;激活&quot;，输入许可证或登录MathWorks账号

3. 基础配置（关键！）：
   &gt;&gt; cd(&#39;D:\MATLAB\R2024b\bin&#39;)  % 进入安装目录
   &gt;&gt; matlab -register            % 注册环境变量（Windows）
   
   % 设置默认工作路径（避免每次打开都在C盘）
   &gt;&gt; userpath(&#39;D:\MyMATLABProjects&#39;)
   &gt;&gt; savepath<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>1.4 Gurobi学术许可证申请（全程图文）</strong></p>
<p>这是最容易卡壳的环节，务必按步骤操作：</p>
<pre class="line-numbers language-none"><code class="language-none">【申请流程（学生版）】
1. 访问 Gurobi 官网：https:&#x2F;&#x2F;www.gurobi.com&#x2F;
2. 点击 &quot;Free Trial&quot; → &quot;Academic Licenses&quot;
3. 选择 &quot;Gurobi Academic License&quot;（不是Gurobi Cloud！）
4. 填写信息：
   - First Name: 你的名（拼音，如 Xiaoming）
   - Last Name: 你的姓（拼音，如 Zhang）
   - Email: 教育网邮箱（关键！必须是 .edu.cn 或学校邮箱）
   - Institution: 你的大学全称
5. 提交后，邮箱会收到验证邮件，点击链接
6. 登录Gurobi账户，进入 &quot;Downloads&quot; 页面
7. 下载对应版本（建议 11.0.3 及以上）
8. 安装时勾选 &quot;Install for all users&quot;（避免权限问题）

【激活许可证】
1. 安装完成后，打开 &quot;Gurobi License Center&quot;
2. 复制你的许可证密钥（格式：xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx）
3. 打开MATLAB，输入：
   &gt;&gt; grbgetkey xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
4. 等待激活成功提示

【验证安装】
在MATLAB命令行输入：
&gt;&gt; g &#x3D; gurobi()
如果显示 &quot;Gurobi Optimizer version 11.0.3...&quot;，说明安装成功<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>1.5 YALMIP安装（最简单但最重要）</strong></p>
<pre class="line-numbers language-none"><code class="language-none">【安装步骤】
1. 访问 YALMIP 官网：http:&#x2F;&#x2F;yalmip.github.io&#x2F;
2. 点击 &quot;Download&quot; → &quot;Download ZIP&quot;
3. 解压到：D:\MATLAB\R2024b\toolbox\yalmip（推荐路径）
4. 在MATLAB中添加路径：
   &gt;&gt; addpath(&#39;D:\MATLAB\R2024b\toolbox\yalmip&#39;)
   &gt;&gt; savepath  % 永久保存路径

【验证安装】
在MATLAB命令行输入：
&gt;&gt; yalmiptest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>预期输出应包含：</strong> <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
|       Test|   CPLEX|   GUROBI|   MOSEK|   SDPT3|   SEDUMI|   FMINCON|
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
|    Linear |    OK  |    OK   |   OK   |   OK   |   OK    |    OK    |
|      SOCP |    OK  |    OK   |   OK   |   OK   |   OK    |    OK    |
|   InfeasLP|    OK  |    OK   |   OK   |   OK   |   OK    |    OK    |
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<strong>关键</strong>：Gurobi栏必须显示”OK”，否则需检查许可证或路径。</p>
<h4 id="晚上1小时环境测试与第一个程序">0.1.1.3. 晚上（1小时）：环境测试与第一个程序</h4>
<p><strong>1.6 运行你的第一个优化问题</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 文件名：test_optimization.m
% 问题描述：minimize x^2 + y^2，满足 x + y &#x3D; 1

clear all; clc;  % 清除变量和命令行

% 步骤1：定义变量
x &#x3D; sdpvar(1,1);  % 实数变量x
y &#x3D; sdpvar(1,1);  % 实数变量y

% 步骤2：设置约束
Constraints &#x3D; [x + y &#x3D;&#x3D; 1];  % 注意：&#x3D;&#x3D; 表示等式约束

% 步骤3：设置目标函数
Objective &#x3D; x^2 + y^2;  % 最小化平方和

% 步骤4：求解设置
options &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;verbose&#39;,1);  % 显示求解过程

% 步骤5：求解
diary(&#39;solver_log.txt&#39;);  % 记录日志
result &#x3D; optimize(Constraints, Objective, options);
diary off;  % 关闭日志

% 步骤6：提取结果
if result.problem &#x3D;&#x3D; 0  % 求解成功
    x_opt &#x3D; value(x);
    y_opt &#x3D; value(y);
    fprintf(&#39;最优解: x &#x3D; %.4f, y &#x3D; %.4f\n&#39;, x_opt, y_opt);
    fprintf(&#39;最优目标值: %.4f\n&#39;, value(Objective));
else
    fprintf(&#39;求解失败，错误代码: %d\n&#39;, result.problem);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>常见问题排查：</strong> - 错误”Undefined function
‘sdpvar’“：YALMIP路径未添加成功，重新addpath - 错误”Gurobi license
error”：许可证未激活或过期，重新运行grbgetkey - 错误”Infeasible
model”：约束矛盾，检查==和&lt;=的使用</p>
<hr>
<h3 id="第二天数学基础补全与yalmip核心语法">0.1.2. 第二天：数学基础补全与YALMIP核心语法</h3>
<h4 id="上午2.5小时优化问题的数学分类">0.1.2.1. 上午（2.5小时）：优化问题的数学分类</h4>
<p><strong>2.1 问题的分类体系（必须理解）</strong></p>
<pre class="line-numbers language-none"><code class="language-none">优化问题分类树：

               优化问题
                 │
        ┌────────┴────────┐
    线性规划(LP)        非线性规划
                         │
              ┌──────────┴──────────┐
         二次规划(QP)            一般非线性(NLP)
              │
        ┌─────┴─────┐
    凸QP          非凸QP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>详细解释（逐项拆解）：</strong></p>
<p><strong>① 线性规划 (LP - Linear Programming)</strong> -
<strong>数学形式</strong>：所有表达式都是线性的（变量的1次方）
<pre class="line-numbers language-wolfram" data-language="wolfram"><code class="language-wolfram">minimize: c₁x₁ + c₂x₂ + ... + cₙxₙ
subject to: a₁₁x₁ + a₁₂x₂ + ... + a₁ₙxₙ ≤ b₁
            a₂₁x₁ + a₂₂x₂ + ... + a₂ₙxₙ ≤ b₂
            xᵢ ≥ 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre> -
<strong>YALMIP特点</strong>：使用<code>sdpvar</code>定义变量，目标函数和约束都是线性表达式
-
<strong>求解难度</strong>：★☆☆☆☆（Gurobi可在毫秒级求解百万变量问题）</p>
<p><strong>② 混合整数线性规划 (MILP - Mixed Integer LP)</strong> -
<strong>数学形式</strong>：LP + 部分变量必须是整数（通常是0或1）
<pre class="line-numbers language-wolfram" data-language="wolfram"><code class="language-wolfram">xᵢ ∈ &#123;0,1&#125; 表示&quot;是否选择i&quot;，或 xᵢ ∈ ℤ 表示&quot;整数个&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre> -
<strong>YALMIP特点</strong>：使用<code>binvar</code>或<code>intvar</code>定义变量
- <strong>求解难度</strong>：★★★★☆（NP-hard问题，Gurobi的最强项）</p>
<p><strong>③ 二次规划 (QP - Quadratic Programming)</strong> -
<strong>数学形式</strong>：目标函数是二次的，约束是线性的 <pre class="line-numbers language-wolfram" data-language="wolfram"><code class="language-wolfram">minimize: xᵀQx + cᵀx  (Q是二次项系数矩阵)
subject to: Ax ≤ b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
- <strong>YALMIP特点</strong>：目标函数可写为<code>x'*Q*x + c'*x</code>
- <strong>求解难度</strong>：★★★☆☆（凸QP易解，非凸QP极难）</p>
<p><strong>④ 二阶锥规划 (SOCP - Second Order Cone Programming)</strong>
- <strong>数学形式</strong>：包含范数约束 <pre class="line-numbers language-wolfram" data-language="wolfram"><code class="language-wolfram">||Ax + b||₂ ≤ cᵀx + d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre> -
<strong>YALMIP特点</strong>：可写为<code>norm(A*x + b) &lt;= c'*x + d</code>
- <strong>求解难度</strong>：★★★☆☆</p>
<p><strong>2.2 YALMIP核心语法深度解析</strong></p>
<p><strong>语法1：定义变量（sdpvar/binvar/intvar）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 1. 实数变量（sdpvar）
x &#x3D; sdpvar(1);              % 标量实数变量
x_vec &#x3D; sdpvar(3,1);        % 3×1列向量 [x1;x2;x3]
x_mat &#x3D; sdpvar(2,3);        % 2×3矩阵（每个元素都是变量）

% 2. 二元变量（binvar）- 只能取0或1
y &#x3D; binvar(1);              % 开关变量
y_vec &#x3D; binvar(5,1);        % 5个开关的组合

% 3. 整数变量（intvar）
z &#x3D; intvar(1);              % 整数变量（如购买数量）
z_mat &#x3D; intvar(3,3);        % 3×3整数矩阵

% 4. 特殊形式：对称矩阵变量（用于SDP问题）
X &#x3D; sdpvar(3,3,&#39;symmetric&#39;); % 3×3对称矩阵，X &#x3D; X&#39;

% 5. 多维变量：决策变量是三维张量（高阶问题）
W &#x3D; sdpvar([2,3,4]);        % 2×3×4三维变量数组

% 重要技巧：变量命名规范
P_gen &#x3D; sdpvar(10,1);       % 发电机功率（10台机组）
u_on &#x3D; binvar(10,1);        % 机组启停状态（1&#x3D;运行）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>语法2：构建约束（Constraints）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 方式1：逐个添加（适合小型问题）
C1 &#x3D; [x &gt;&#x3D; 0];              % 单个约束
C2 &#x3D; [x + y &lt;&#x3D; 10];         % 线性约束
C &#x3D; [C1, C2];               % 约束集合

% 方式2：批量添加（推荐，效率高）
n &#x3D; 100;
x &#x3D; sdpvar(n,1);
A &#x3D; randn(50,n);  b &#x3D; rand(50,1);
C &#x3D; [A*x &lt;&#x3D; b, x &gt;&#x3D; 0];   % 一次性添加50个约束

% 方式3：逻辑约束（需要最新版YALMIP）
y &#x3D; binvar(1);
C &#x3D; [implies(y&#x3D;&#x3D;1, x&gt;&#x3D;5)]; % 如果y&#x3D;1，则x必须≥5

% 方式4：绝对值约束（自动转化为线性约束）
C &#x3D; [abs(x) &lt;&#x3D; 5];          % 等价于 -5 &lt;&#x3D; x &lt;&#x3D; 5

% 方式5：分段约束（分段线性）
C &#x3D; [-5 &lt;&#x3D; x &lt;&#x3D; 5, -3 &lt;&#x3D; y &lt;&#x3D; 3];

% 常见错误示例：
% 错误1：使用等号赋值约束
C &#x3D; [x &#x3D; 5];  % 错误！必须用 &#x3D;&#x3D; 
% 错误2：未初始化的约束数组
C &#x3D; [];  % 正确做法：先初始化为空数组
for i &#x3D; 1:10
    C &#x3D; [C, x(i) &lt;&#x3D; i];  % 逐个添加
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>语法3：设置目标函数（Objective）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 类型1：最小化（最常用）
obj &#x3D; c&#39;*x;                 % 线性目标
obj &#x3D; x&#39;*Q*x + c&#39;*x;        % 二次目标
obj &#x3D; sum(x.^2);            % 平方和

% 类型2：最大化
obj &#x3D; -c&#39;*x;                % 最大化c&#39;*x 等价于 最小化 -c&#39;*x
% 或在求解时指定：
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;solvefor&#39;,&#39;max&#39;);

% 类型3：多目标（加权和）
obj1 &#x3D; c1&#39;*x;  obj2 &#x3D; c2&#39;*x;
weights &#x3D; [0.7, 0.3];
obj &#x3D; weights(1)*obj1 + weights(2)*obj2;

% 重要：目标函数必须是标量
obj &#x3D; sum(x);               % 正确，标量
obj &#x3D; x;                    % 错误，当x是向量时，这是向量目标<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>语法4：求解与结果提取（optimize &amp; value）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 基础求解
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;);
optimize(C, obj, ops);      % 最小化obj
optimize(C, -obj, ops);     % 最大化obj

% 高级设置
ops &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...        % 指定求解器
    &#39;verbose&#39;,1,...              % 显示求解过程
    &#39;debug&#39;,1,...                % 开启调试模式
    &#39;saveinput&#39;,&#39;model.mps&#39;);    % 保存模型到文件

% 结果诊断
result &#x3D; optimize(C, obj, ops);
disp(result);  % 显示求解信息

% result.problem 取值含义：
%   0: 求解成功
%   1: 问题无可行解（约束矛盾）
%   2: 问题无界（目标函数可无限优化）
%   3: 达到迭代限制
%   4: 求解器错误

% 提取结果
if result.problem &#x3D;&#x3D; 0
    x_opt &#x3D; value(x);               % 提取最优解
    obj_opt &#x3D; value(obj);           % 提取最优目标值
    dual_opt &#x3D; dual(C&#123;1&#125;);          % 提取约束的对偶变量（灵敏度分析）
    
    % 格式化输出
    fprintf(&#39;最优目标值: %.4f\n&#39;, obj_opt);
    disp(&#39;最优解:&#39;);
    disp(x_opt);
else
    % 错误处理
    switch result.problem
        case 1
            error(&#39;模型无可行解，请检查约束条件！&#39;);
        case 2
            error(&#39;模型无界，请检查目标函数和约束！&#39;);
        otherwise
            error(&#39;求解失败，错误代码: %d&#39;, result.problem);
    end
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="下午2小时yalmip调试技巧与常见错误">0.1.2.2. 下午（2小时）：YALMIP调试技巧与常见错误</h4>
<p><strong>2.3 调试工具箱</strong></p>
<p>你的问题非常好！你提供的代码片段反映了你在使用
<strong>YALMIP</strong> 进行建模和调试，但其中确实 <strong>混入了一些非
YALMIP 的函数或用法错误</strong>。下面我将：</p>
<ol type="1">
<li><strong>逐条分析你例子中的问题</strong>；</li>
<li><strong>系统介绍 YALMIP 正确的调试方法</strong>；</li>
<li><strong>提供修正后的可运行示例</strong>。</li>
</ol>
<hr>
<h3 id="一你例子中的问题分析">0.1.3. 一、你例子中的问题分析</h3>
<h4 id="analyzec">0.1.3.1. ❌ analyze(C)</h4>
<ul>
<li><strong>问题</strong>：YALMIP <strong>没有</strong>名为
<code>analyze</code> 的函数。</li>
<li><strong>正确做法</strong>：可用 <code>sdisplay(C)</code>
查看约束表达式，或用 <code>depends(C)</code> 查看涉及的变量，但
<strong>没有一键显示变量数、约束数、问题类型的函数</strong>。</li>
<li>若想查看模型结构，推荐使用： <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 查看约束内容
sdisplay(C)
% 查看所有变量
all_vars &#x3D; allvariables(C, obj);  % obj 是目标函数
disp([&#39;Number of variables: &#39;, num2str(length(all_vars))]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h4 id="assignx5-checkc">0.1.3.2. ❌ assign(x,5); check(C)</h4>
<ul>
<li><strong>问题 1</strong>：你定义的是
<code>n = binvar(10...</code>，但后面用
<code>assign(x,5)</code>，变量名不一致（<code>x</code> 未定义）。</li>
<li><strong>问题 2</strong>：<code>check</code> 不是 YALMIP 函数。</li>
<li><strong>正确做法</strong>： <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">assign(n, some_binary_vector);  % 必须是 0&#x2F;1 向量，长度1000
value(C)  % 返回每个约束的数值（如 sum(n) &lt;&#x3D; 500 的左边值）
% 检查是否满足：所有 value(C) &lt;&#x3D; 0（因为 YALMIP 把约束表示为 &lt;&#x3D; 0 形式）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h4 id="feasibility-optimizecops">0.1.3.3. ❌
feasibility = optimize(C,[],ops);</h4>
<ul>
<li><strong>语法问题</strong>：YALMIP 的 <code>optimize</code>
<strong>不能接受空目标（[]）</strong>。</li>
<li><strong>正确做法</strong>：使用 <code>0</code> 作为目标（常数）：
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">feasibility &#x3D; optimize(C, 0, ops);  % 仅求可行解<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<h4 id="dispvalueobj-但-obj-未定义">0.1.3.4. ❌ disp(value(obj)); 但
obj 未定义</h4>
<ul>
<li>在工具1和工具4中你都没有定义
<code>obj</code>，但工具5却用了它。</li>
<li>这会导致运行错误。</li>
</ul>
<h4 id="saveinput-参数拼写错误">0.1.3.5. ❌ saveinput
参数拼写错误</h4>
<ul>
<li>正确参数是 <code>'savesolverinput'</code> 或
<code>'saveduals'</code>，但 <strong>YALMIP 没有
<code>'saveinput'</code></strong>。</li>
<li>若想导出 <code>.lp</code> 文件，应使用： <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;, &#39;savesolverinput&#39;, &#39;debug.lp&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre> 或更推荐用：
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">export(C, obj, &#39;debug.lp&#39;);  % 直接导出模型，不求解<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<hr>
<h3 id="二yalmip-正确的调试方法系统总结">0.1.4. 二、YALMIP
正确的调试方法（系统总结）</h3>
<h4 id="检查模型结构">0.1.4.1. ✅ 1. 检查模型结构</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">n &#x3D; binvar(1000,1);
C &#x3D; [sum(n) &lt;&#x3D; 500];
obj &#x3D; sum(n);  % 示例目标

% 查看约束表达式
sdisplay(C)

% 查看所有变量
vars &#x3D; allvariables(C, obj);
fprintf(&#39;变量数量: %d (应为1000)\n&#39;, length(vars));

% 查看问题是否为混合整数
is_mip &#x3D; any([vars(:).binvar]) || any([vars(:).intvar]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="导出模型为-lpmps-文件">0.1.4.2. ✅ 2. 导出模型为 LP/MPS
文件</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">export(C, obj, &#39;model.lp&#39;);  % 不求解，仅导出
% 然后用文本编辑器打开 model.lp<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="手动赋值并验证约束">0.1.4.3. ✅ 3.
手动赋值并验证约束</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 构造一个可行解：前500个为1，其余为0
test_val &#x3D; [ones(500,1); zeros(500,1)];
assign(n, test_val);
con_vals &#x3D; value(C);  % 例如返回 -1（表示 sum(n)-500 &#x3D; -1 &lt;&#x3D; 0）
fprintf(&#39;约束值: %.2f (应 &lt;&#x3D; 0)\n&#39;, con_vals);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>⚠️ 注意：<code>assign</code> 只用于调试，<strong>不会影响 optimize
的求解</strong>。求解时 YALMIP 会忽略手动赋值。</p>
</blockquote>
<h4 id="仅求可行解feasibility-check">0.1.4.4. ✅ 4.
仅求可行解（Feasibility Check）</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">ops &#x3D; sdpsettings(&#39;verbose&#39;, 1);  % 显示求解器输出
feas &#x3D; optimize(C, 0, ops);       % 目标为 0
if feas.problem &#x3D;&#x3D; 0
    disp(&#39;找到可行解&#39;);
else
    disp(&#39;问题不可行&#39;);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="检查目标函数值在某赋值下">0.1.4.5. ✅ 5.
检查目标函数值（在某赋值下）</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">assign(n, test_val);
obj_val &#x3D; value(obj);
disp([&#39;目标值: &#39;, num2str(obj_val)]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="查看求解器返回信息">0.1.4.6. ✅ 6.
查看求解器返回信息</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">sol &#x3D; optimize(C, obj, ops);
if sol.problem ~&#x3D; 0
    disp([&#39;求解失败，错误代码: &#39;, num2str(sol.problem)]);
    % 常见：1&#x3D;不可行，2&#x3D;无界，3&#x3D;求解失败
else
    optimal_n &#x3D; value(n);
    optimal_obj &#x3D; value(obj);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="使用-spy-查看稀疏结构对大型问题">0.1.4.7. ✅ 7. 使用
spy 查看稀疏结构（对大型问题）</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 查看约束矩阵结构（需先构造内部模型）
diagnostic &#x3D; optimize(C, obj, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;debug&#39;,1));
% 或使用 internal model
[F, f] &#x3D; model(C, obj);  % 不推荐直接用，但可用于分析<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="三修正后的完整示例">0.1.5. 三、修正后的完整示例</h3>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 定义变量
n &#x3D; binvar(1000, 1);

% 约束
C &#x3D; [sum(n) &lt;&#x3D; 500];

% 目标（假设最小化 sum(n)）
obj &#x3D; sum(n);

% 1. 检查模型
fprintf(&#39;变量数: %d\n&#39;, length(allvariables(C, obj)));
sdisplay(C)

% 2. 导出模型
export(C, obj, &#39;debug.lp&#39;);

% 3. 可行性检查
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;verbose&#39;,0);
feas &#x3D; optimize(C, 0, ops);
if feas.problem &#x3D;&#x3D; 0
    disp(&#39;模型可行&#39;);
else
    disp(&#39;模型不可行！&#39;);
end

% 4. 手动赋值验证
assign(n, [ones(300,1); zeros(700,1)]);
con_val &#x3D; value(C);
obj_val &#x3D; value(obj);
fprintf(&#39;手动赋值下：约束值&#x3D;%.1f (&lt;&#x3D;0?), 目标值&#x3D;%.1f\n&#39;, con_val, obj_val);

% 5. 正常求解
sol &#x3D; optimize(C, obj, ops);
if sol.problem &#x3D;&#x3D; 0
    fprintf(&#39;最优目标: %.1f\n&#39;, value(obj));
else
    error(&#39;求解失败&#39;);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="总结">0.1.6. 总结</h3>
<ul>
<li><code>analyze</code>, <code>check</code> 不是 YALMIP 函数；</li>
<li>空目标 <code>[]</code> 应替换为 <code>0</code>；</li>
<li>变量名要一致（你用了 <code>n</code> 但赋值 <code>x</code>）；</li>
<li>使用 <code>assign</code> + <code>value</code>
是调试赋值的有效方法；</li>
<li>用 <code>export</code> 导出 <code>.lp</code> 文件，比
<code>saveinput</code> 更可靠；</li>
<li>始终检查 <code>sol.problem</code> 判断求解状态。</li>
</ul>
<p>如果你有具体的模型不可行、求解慢、结果异常等问题，也可以贴出来，我可以帮你进一步诊断。</p>
<p><strong>2.4 十个新手必犯错误与解决方案</strong></p>
<table>
<colgroup>
<col style="width: 35%">
<col style="width: 25%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>错误现象</th>
<th>原因分析</th>
<th>解决方案</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Undefined function 'sdpvar'</code></td>
<td>YALMIP路径未添加</td>
<td><code>addpath('.../yalmip'); savepath</code></td>
</tr>
<tr class="even">
<td><code>Gurobi license error 10009</code></td>
<td>学术许可证未激活</td>
<td>重新运行<code>grbgetkey</code>，检查系统时间</td>
</tr>
<tr class="odd">
<td><code>Model is infeasible</code></td>
<td>约束矛盾</td>
<td>用<code>relax(C)</code>或逐个注释约束排查</td>
</tr>
<tr class="even">
<td><code>Matrix dimensions must agree</code></td>
<td>矩阵维度不匹配</td>
<td>用<code>size()</code>检查变量和系数矩阵维度</td>
</tr>
<tr class="odd">
<td><code>Objective must be scalar</code></td>
<td>目标函数是向量</td>
<td>使用<code>sum()</code>或<code>square_pos()</code>转换</td>
</tr>
<tr class="even">
<td><code>Cannot convert sdpvar to double</code></td>
<td>在optimize前使用value()</td>
<td>只在求解后使用value()提取结果</td>
</tr>
<tr class="odd">
<td><code>Solver not found</code></td>
<td>Gurobi未正确安装</td>
<td>运行<code>gurobi_setup</code>，检查MATLAB路径</td>
</tr>
<tr class="even">
<td><code>Out of memory</code></td>
<td>问题规模太大</td>
<td>使用<code>sparse()</code>创建稀疏矩阵</td>
</tr>
<tr class="odd">
<td><code>Undefined operator '*'</code></td>
<td>非线性项错误</td>
<td>检查二次项是否写成<code>x'*Q*x</code>形式</td>
</tr>
<tr class="even">
<td><code>Warning: Solver not applicable</code></td>
<td>问题类型与求解器不匹配</td>
<td>检查是否是MILP却用了不支持整数求解器</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="第三天问题类型实战与参数调优">0.1.7. 第三天：问题类型实战与参数调优</h3>
<h4 id="上午2.5小时参数调优详解">0.1.7.1. 上午（2.5小时）：参数调优详解</h4>
<p><strong>3.1 Gurobi参数体系（性能调优关键）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 参数设置结构
ops &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;gurobi.MIPGap&#39;,0.01,...        % MIP间隙容忍度（1%）
    &#39;gurobi.TimeLimit&#39;,3600,...     % 时间限制（秒）
    &#39;gurobi.Threads&#39;,8,...          % 使用CPU核数
    &#39;gurobi.OutputFlag&#39;,1,...       % 显示迭代过程
    &#39;gurobi.Heuristics&#39;,0.5,...     % 启发式算法强度
    &#39;gurobi.CutPasses&#39;,2,...        % 割平面法迭代次数
    &#39;gurobi.Presolve&#39;,2,...         % 预求解级别（0-2）
    &#39;gurobi.Method&#39;,-1,...          % 算法选择（-1&#x3D;自动）
    &#39;gurobi.LogFile&#39;,&#39;gurobi.log&#39;);% 日志文件

% 常用参数组合模板：

% 模板1：快速可行解（适合初次运行）
ops_fast &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;gurobi.MIPFocus&#39;,1,...         % 重点找可行解
    &#39;gurobi.Heuristics&#39;,0.8,...     % 加强启发式
    &#39;gurobi.TimeLimit&#39;,300);        % 5分钟上限

% 模板2：精确最优解（适合最终求解）
ops_accurate &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;gurobi.MIPGap&#39;,0.001,...       % 0.1%精度
    &#39;gurobi.MIPFocus&#39;,2,...         % 重点优化界
    &#39;gurobi.Cuts&#39;,3,...             % 激进割平面
    &#39;gurobi.NodeMethod&#39;,2);         % 节点用对偶单纯形

% 模板3：大规模问题（内存受限）
ops_large &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;gurobi.Threads&#39;,4,...          % 限制线程数
    &#39;gurobi.NodefileStart&#39;,0.5,...  % 内存占用50%时转硬盘
    &#39;gurobi.Method&#39;,2,...           % 使用内点法
    &#39;gurobi.BarConvTol&#39;,1e-4);     % 降低精度换速度<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>3.2 参数调优案例：背包问题性能对比</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 问题：100个物品中选择，价值最大化
n &#x3D; 100;
value &#x3D; rand(n,1)*100;
weight &#x3D; rand(n,1)*50;
capacity &#x3D; 1000;

% 定义变量
x &#x3D; binvar(n,1);

% 约束
C &#x3D; [sum(weight.*x) &lt;&#x3D; capacity];

% 目标
obj &#x3D; -value&#39;*x;  % 最大化价值

% 测试不同参数
param_sets &#x3D; &#123;
    &#123;&#39;MIPGap&#39;,0.01,&#39;Threads&#39;,4&#125;;
    &#123;&#39;MIPGap&#39;,0.05,&#39;Heuristics&#39;,0.8&#125;;
    &#123;&#39;MIPGap&#39;,0.001,&#39;Cuts&#39;,3,&#39;MIPFocus&#39;,2&#125;;
&#125;;

for i &#x3D; 1:length(param_sets)
    fprintf(&#39;\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 参数组合 %d &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n&#39;, i);
    ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,...
        param_sets&#123;i&#125;&#123;:&#125;,&#39;verbose&#39;,1,&#39;savesolveroutput&#39;,1);
    
    tic;
    result &#x3D; optimize(C, obj, ops);
    time &#x3D; toc;
    
    if result.problem &#x3D;&#x3D; 0
        fprintf(&#39;求解时间: %.2f 秒\n&#39;, time);
        fprintf(&#39;目标值: %.2f\n&#39;, -value(value(x)));
        fprintf(&#39;节点数: %d\n&#39;, result.solveroutput.IterCount);
    end
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h4 id="下午2.5小时第一阶段总结与实战检验">0.1.7.2. 下午（2.5小时）：第一阶段总结与实战检验</h4>
<p><strong>3.3 第一阶段综合测试题</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 任务：生产排程问题
% 工厂生产A、B两种产品，需要经过机器M1、M2
% 数据：
%  - 产品A利润：30元&#x2F;件，M1耗时2h，M2耗时3h
%  - 产品B利润：50元&#x2F;件，M1耗时4h，M2耗时2h
%  - M1可用时间：120h&#x2F;周，M2可用时间：100h&#x2F;周
%  - 产品A最大销量：25件&#x2F;周
% 求：利润最大的生产方案

% 请完成以下代码（填空）：
% 1. 定义变量
x_A &#x3D; ______(1,1);  % 产品A产量
x_B &#x3D; ______(1,1);  % 产品B产量

% 2. 约束条件
C &#x3D; [2*x_A + 4*x_B &lt;&#x3D; ______,  % M1时间约束
     3*x_A + 2*x_B &lt;&#x3D; ______,  % M2时间约束
     ______ &lt;&#x3D; 25,             % 销量约束
     x_A &gt;&#x3D; 0, x_B &gt;&#x3D; 0];

% 3. 目标函数
Profit &#x3D; ______*x_A + ______*x_B;

% 4. 求解
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;);
result &#x3D; optimize(C, -Profit, ops);  % 最大化利润

% 5. 结果输出
if result.problem &#x3D;&#x3D; ____
    fprintf(&#39;最优生产：A&#x3D;%.0f件, B&#x3D;%.0f件\n&#39;, ______, ______);
    fprintf(&#39;最大利润：%.0f元\n&#39;, ______);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>答案与解析：</strong> <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 答案：
x_A &#x3D; sdpvar(1,1);
x_B &#x3D; sdpvar(1,1);
C &#x3D; [2*x_A + 4*x_B &lt;&#x3D; 120,
     3*x_A + 2*x_B &lt;&#x3D; 100,
     x_A &lt;&#x3D; 25,
     x_A &gt;&#x3D; 0, x_B &gt;&#x3D; 0];
Profit &#x3D; 30*x_A + 50*x_B;
result &#x3D; optimize(C, -Profit, ops);
if result.problem &#x3D;&#x3D; 0
    fprintf(&#39;最优生产：A&#x3D;%.0f件, B&#x3D;%.0f件\n&#39;, value(x_A), value(x_B));
    fprintf(&#39;最大利润：%.0f元\n&#39;, value(Profit));
end
% 最优解：A&#x3D;20件, B&#x3D;20件, 利润&#x3D;1600元<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<p><strong>3.4 第一阶段学习检查清单</strong></p>
<ul class="task-list">
<li><label><input type="checkbox">能独立安装MATLAB、Gurobi、YALMIP</label></li>
<li><label><input type="checkbox">运行yalmiptest显示Gurobi为OK</label></li>
<li><label><input type="checkbox">理解sdpvar/binvar/intvar的区别</label></li>
<li><label><input type="checkbox">能写出至少3种约束条件</label></li>
<li><label><input type="checkbox">会设置目标函数（最小化和最大化）</label></li>
<li><label><input type="checkbox">会调用optimize并提取value</label></li>
<li><label><input type="checkbox">能读懂Gurobi求解日志</label></li>
<li><label><input type="checkbox">遇到”Infeasible”知道如何排查</label></li>
</ul>
<hr>
<h2 id="第二阶段经典模型实战第2周">0.2. 第二阶段：经典模型实战（第2周）</h2>
<h3 id="第4天线性规划lp深度实战">0.2.1. 第4天：线性规划（LP）深度实战</h3>
<h4 id="上午3小时线性规划理论体系">0.2.1.1. 上午（3小时）：线性规划理论体系</h4>
<p><strong>4.1 线性规划标准形式与转换</strong></p>
<pre class="line-numbers language-wolfram" data-language="wolfram"><code class="language-wolfram">标准形式：
minimize    cᵀx
subject to  Ax &#x3D; b
            x ≥ 0

实际问题的转换技巧：
1. 不等式转等式：添加松弛变量
   aᵢᵀx ≤ bᵢ   →   aᵢᵀx + sᵢ &#x3D; bᵢ, sᵢ ≥ 0
   
2. 自由变量处理：x无约束 → x &#x3D; x⁺ - x⁻, x⁺,x⁻ ≥ 0
   
3. 最大化转最小化：
   max cᵀx  →  min -cᵀx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>4.2 生产排程问题完整案例</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 问题描述：
% 某工厂生产4种产品(P1-P4)，使用3种原材料(R1-R3)
% 数据：
% 利润向量（万元&#x2F;吨）：[5, 8, 6, 7]
% 原材料消耗矩阵（吨原材料&#x2F;吨产品）：
%        P1  P2  P3  P4
% R1     2   3   1   2
% R2     1   2   3   1
% R3     3   1   2   3
% 原材料可用量（吨）：R1&#x3D;150, R2&#x3D;180, R3&#x3D;200
% 市场需求上限（吨）：P1&#x3D;30, P2&#x3D;40, P3&#x3D;35, P4&#x3D;25

% MATLAB实现（工业级代码）：

%% 第一步：数据准备（通常从Excel读取）
profit &#x3D; [5; 8; 6; 7];  % 利润向量
A &#x3D; [2 3 1 2;          % 原材料消耗矩阵
     1 2 3 1;
     3 1 2 3];
b &#x3D; [150; 180; 200];    % 原材料上限
demand &#x3D; [30; 40; 35; 25]; % 市场需求

%% 第二步：定义决策变量
x &#x3D; sdpvar(4,1);  % x(i)表示产品i的产量

%% 第三步：构建约束条件（矩阵化风格）
Constraints &#x3D; [
    A*x &lt;&#x3D; b,        % 原材料约束（3个约束，一行代码）
    x &gt;&#x3D; 0,          % 非负约束
    x &lt;&#x3D; demand      % 市场需求约束
];

%% 第四步：设置目标函数（最大化利润）
Objective &#x3D; -profit&#39;*x;  % 负号因为YALMIP默认最小化

%% 第五步：求解设置（工业级参数）
ops &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;verbose&#39;,1,...
    &#39;gurobi.Method&#39;,0,...         % 自动选择算法
    &#39;gurobi.FeasibilityTol&#39;,1e-6,... % 可行性容差
    &#39;gurobi.OptimalityTol&#39;,1e-6);   % 最优性容差

%% 第六步：求解与结果输出
result &#x3D; optimize(Constraints, Objective, ops);

%% 第七步：结果分析与可视化
if result.problem &#x3D;&#x3D; 0
    x_opt &#x3D; value(x);
    profit_opt &#x3D; -value(Objective);
    
    % 创建结果表格
    fprintf(&#39;\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 生产排程最优方案 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n&#39;);
    fprintf(&#39;%-10s %-15s %-15s\n&#39;, &#39;产品&#39;, &#39;产量(吨)&#39;, &#39;利润(万元)&#39;);
    fprintf(&#39;----------------------------------------\n&#39;);
    for i &#x3D; 1:4
        fprintf(&#39;%-10s %-15.2f %-15.2f\n&#39;, [&#39;P&#39;,num2str(i)], x_opt(i), profit(i)*x_opt(i));
    end
    fprintf(&#39;----------------------------------------\n&#39;);
    fprintf(&#39;总利润: %.2f 万元\n&#39;, profit_opt);
    
    % 可视化
    figure;
    subplot(2,1,1);
    bar(x_opt);
    set(gca,&#39;xticklabel&#39;,&#123;&#39;P1&#39;,&#39;P2&#39;,&#39;P3&#39;,&#39;P4&#39;&#125;);
    title(&#39;最优生产方案&#39;);
    ylabel(&#39;产量(吨)&#39;);
    
    subplot(2,1,2);
    pie(x_opt, &#123;&#39;P1&#39;,&#39;P2&#39;,&#39;P3&#39;,&#39;P4&#39;&#125;);
    title(&#39;产量分布&#39;);
else
    error(&#39;求解失败，错误代码: %d&#39;, result.problem);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>4.3 灵敏度分析（Shadow Price）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 在求解后提取对偶变量
if result.problem &#x3D;&#x3D; 0
    % 原材料约束的对偶变量（影子价格）
    shadow_price &#x3D; dual(Constraints(1:3));
    fprintf(&#39;\n原材料影子价格（万元&#x2F;吨）:\n&#39;);
    fprintf(&#39;R1: %.4f\n&#39;, shadow_price(1));
    fprintf(&#39;R2: %.4f\n&#39;, shadow_price(2));
    fprintf(&#39;R3: %.4f\n&#39;, shadow_price(3));
    % 影子价格&gt;0表示该原材料是瓶颈资源
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h4 id="下午3小时运输问题与指派问题">0.2.1.2. 下午（3小时）：运输问题与指派问题</h4>
<p><strong>4.4 运输问题（Transportation Problem）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 问题：3个工厂 → 4个仓库，最小化运输成本

% 数据
supply &#x3D; [100; 150; 200];  % 工厂供应量
demand &#x3D; [80; 90; 120; 160]; % 仓库需求量
cost &#x3D; [4 5 6 8;           % 单位运输成本矩阵（工厂×仓库）
        6 4 3 5;
        7 8 5 6];

% 决策变量：x(i,j)表示从工厂i到仓库j的运量
x &#x3D; sdpvar(3,4,&#39;full&#39;);  % &#39;full&#39;表示非对称矩阵

% 约束
Constraints &#x3D; [
    sum(x,2) &#x3D;&#x3D; supply,    % 行和&#x3D;供应（每个工厂运出量）
    sum(x,1)&#39; &#x3D;&#x3D; demand,   % 列和&#x3D;需求（每个仓库接收量）
    x &gt;&#x3D; 0                 % 非负
];

% 目标
Objective &#x3D; sum(sum(cost.*x));  % 总成本

% 求解
optimize(Constraints, Objective, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;));

% 结果展示
x_opt &#x3D; value(x);
fprintf(&#39;\n最优运输方案:\n&#39;);
for i &#x3D; 1:3
    for j &#x3D; 1:4
        if x_opt(i,j) &gt; 0.1
            fprintf(&#39;工厂%d → 仓库%d: %.1f 吨\n&#39;, i, j, x_opt(i,j));
        end
    end
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>4.5 指派问题（Assignment Problem）——纯0-1问题</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 问题：5个工人 → 5个任务，最小化总工时

% 数据：工时矩阵
time_cost &#x3D; [9 2 7 8 2;
             6 4 3 7 6;
             5 8 1 4 7;
             7 6 9 8 5;
             2 3 4 5 6];

n &#x3D; 5;
% 决策变量：x(i,j)&#x3D;1表示工人i做任务j
x &#x3D; binvar(n,n);  % 5×5二元矩阵

% 约束：每个工人只做1个任务，每个任务只由1个工人做
Constraints &#x3D; [
    sum(x,2) &#x3D;&#x3D; 1,  % 行和&#x3D;1（每个工人1个任务）
    sum(x,1)&#39; &#x3D;&#x3D; 1  % 列和&#x3D;1（每个任务1个工人）
];

% 目标
Objective &#x3D; sum(sum(time_cost.*x));

% 求解（Gurobi在此类问题上性能卓越）
optimize(Constraints, Objective, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;));

% 结果
x_opt &#x3D; value(x);
fprintf(&#39;\n任务分配方案:\n&#39;);
for i &#x3D; 1:n
    for j &#x3D; 1:n
        if x_opt(i,j) &gt; 0.5
            fprintf(&#39;工人%d ←→ 任务%d (工时:%d)\n&#39;, i, j, time_cost(i,j));
        end
    end
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第5天混合整数线性规划milpgurobi最擅长的领域">0.2.2. 第5天：混合整数线性规划（MILP）——Gurobi最擅长的领域</h3>
<h4 id="上午3小时milp核心理论与建模技巧">0.2.2.1. 上午（3小时）：MILP核心理论与建模技巧</h4>
<p><strong>5.1 为什么MILP这么难？（NP-hard问题）</strong></p>
<pre class="line-numbers language-none"><code class="language-none">MILP的求解复杂度：
- 若有n个二元变量，理论上需要检查2ⁿ种组合
- 当n&#x3D;100时，2¹⁰⁰ ≈ 1.27×10³⁰，比宇宙中原子总数还多
- Gurobi的Branch-and-Cut算法：通过剪枝和割平面，实际只需检查极小一部分组合

Gurobi在MILP上的优势：
1. 先进的预求解技术（Presolve）：可消去30-50%的变量和约束
2. 启发式算法（Heuristics）：快速找到高质量可行解
3. 割平面（Cutting Planes）：强化松弛问题，逼近整数解
4. 并行计算：利用多核CPU加速分支定界<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>5.2 背包问题（Knapsack Problem）——MILP入门</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 问题：容量15kg的背包，选哪些物品使总价值最大

% 数据：10个物品
weights &#x3D; [2,3,4,5,6,1,2,3,4,5];  % 重量(kg)
values  &#x3D; [3,5,6,8,9,2,3,4,6,7];  % 价值
capacity &#x3D; 15;

n &#x3D; length(weights);
% 决策变量：x(i)&#x3D;1表示选第i个物品
x &#x3D; binvar(n,1);

% 约束
Constraints &#x3D; [weights*x &lt;&#x3D; capacity];

% 目标
Objective &#x3D; -values&#39;*x;  % 最大化价值

% 求解
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.MIPGap&#39;,0.01);
result &#x3D; optimize(Constraints, Objective, ops);

% 结果
x_opt &#x3D; value(x);
fprintf(&#39;\n选中物品: &#39;);
for i &#x3D; 1:n
    if x_opt(i) &gt; 0.5
        fprintf(&#39;%d &#39;, i);
    end
end
fprintf(&#39;\n总价值: %.0f\n&#39;, -value(Objective));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>5.3 设施选址问题（Facility Location）——经典MILP</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 问题：在5个候选地建仓库，服务10个客户，最小化总成本（建设+运输）

% 数据
build_cost &#x3D; [100,150,120,90,110];  % 建设成本（万元）
transport_cost &#x3D; randn(5,10);       % 运输成本矩阵（5仓库×10客户）
demand &#x3D; ones(10,1)*50;             % 每个客户需求50吨

% 决策变量1：y(i)&#x3D;1表示在i地建仓库
y &#x3D; binvar(5,1);

% 决策变量2：x(i,j)表示仓库i供应客户j的量
x &#x3D; sdpvar(5,10);

% 约束
Constraints &#x3D; [
    sum(x,1)&#39; &#x3D;&#x3D; demand,           % 满足所有客户需求
    sum(x,2) &lt;&#x3D; 1000*y,            % 只有在建的仓库才能供应（大M法）
    x &gt;&#x3D; 0
];

% 目标
Objective &#x3D; build_cost&#39;*y + sum(sum(transport_cost.*x));

% 求解（Gurobi会自动处理大M法）
optimize(Constraints, Objective, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="下午3小时milp高级建模技巧">0.2.2.2. 下午（3小时）：MILP高级建模技巧</h4>
<p><strong>5.4 逻辑约束建模（Indicator Constraints）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 场景：如果工厂开启(y&#x3D;1)，则产量x≥100；否则x&#x3D;0

y &#x3D; binvar(1);  % 开关变量
x &#x3D; sdpvar(1);  % 产量

% 传统大M法（可能数值不稳定）
M &#x3D; 1000;
Constraints &#x3D; [
    x &lt;&#x3D; M*y,
    x &gt;&#x3D; 100*y
];

% YALMIP高级语法（自动转化为Indicator）
Constraints &#x3D; [implies(y&#x3D;&#x3D;1, x&gt;&#x3D;100), implies(y&#x3D;&#x3D;0, x&#x3D;&#x3D;0)];

% YALMIP会自动转换为Gurobi的indicator约束，数值更稳定<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>5.5 分段线性成本函数建模</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 场景：用电成本分段计价
% 0-100度：0.5元&#x2F;度
% 100-200度：0.8元&#x2F;度
% 200度以上：1.2元&#x2F;度

x &#x3D; sdpvar(1);  % 用电量
cost &#x3D; sdpvar(1); % 成本

% 方法1：引入辅助变量和约束
x1 &#x3D; sdpvar(1); x2 &#x3D; sdpvar(1); x3 &#x3D; sdpvar(1);
Constraints &#x3D; [
    x &#x3D;&#x3D; x1 + x2 + x3,
    0 &lt;&#x3D; x1 &lt;&#x3D; 100,
    0 &lt;&#x3D; x2 &lt;&#x3D; 100,
    0 &lt;&#x3D; x3 &lt;&#x3D; inf,
    cost &#x3D;&#x3D; 0.5*x1 + 0.8*x2 + 1.2*x3
];

% 方法2：使用YALMIP的pwlf函数（推荐）
cost &#x3D; pwlf(x, [0 100 200], [0 50 130]); % 断点[0,100,200]，累计成本[0,50,130]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第6天二次规划qp与投资组合优化">0.2.3. 第6天：二次规划（QP）与投资组合优化</h3>
<h4 id="上午3小时qp理论与凸性判断">0.2.3.1. 上午（3小时）：QP理论与凸性判断</h4>
<p><strong>6.1 二次规划的数学本质</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 标准形式：
% minimize  0.5*x&#39;*Q*x + c&#39;*x
% subject to Ax &lt;&#x3D; b

% 关键概念：矩阵Q必须是半正定（PSD）才是凸QP
% Gurobi只能高效求解凸QP

% 判断凸性方法：
Q &#x3D; [2 -1; -1 2];  % 正定矩阵
eig_Q &#x3D; eig(Q);
if all(eig_Q &gt;&#x3D; -1e-6)  % 容忍小负特征值
    disp(&#39;是凸QP，Gurobi可解&#39;);
else
    error(&#39;是非凸QP，Gurobi可能无法找到全局最优&#39;);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>6.2 投资组合优化（Markowitz模型）——经典QP</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 问题：在10支股票中选择投资组合，期望收益≥12%，风险最小

% 数据准备（通常从CSV&#x2F;Excel读取）
returns &#x3D; [0.1;0.12;0.09;0.11;0.13;0.08;0.1;0.09;0.12;0.14];  % 期望收益
cov_matrix &#x3D; cov(randn(100,10));  % 10×10协方差矩阵

% 决策变量：x(i)表示投资比例
x &#x3D; sdpvar(10,1);

% 约束
Constraints &#x3D; [
    sum(x) &#x3D;&#x3D; 1,           % 总投资100%
    x &gt;&#x3D; 0,                % 不允许做空
    returns&#39;*x &gt;&#x3D; 0.12     % 期望收益≥12%
];

% 目标：最小化风险（方差）
Objective &#x3D; x&#39;*cov_matrix*x;  % 二次项

% 求解（Gurobi对凸QP有专门算法）
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.BarHomogeneous&#39;,1);
optimize(Constraints, Objective, ops);

% 结果分析
x_opt &#x3D; value(x);
risk_opt &#x3D; sqrt(value(Objective));  % 标准差
return_opt &#x3D; returns&#39;*x_opt;

fprintf(&#39;\n最优投资组合:\n&#39;);
for i &#x3D; 1:10
    if x_opt(i) &gt; 0.01  % 只显示占比&gt;1%的股票
        fprintf(&#39;股票%d: %.2f%%\n&#39;, i, x_opt(i)*100);
    end
end
fprintf(&#39;预期收益: %.2f%%\n&#39;, return_opt*100);
fprintf(&#39;组合风险: %.4f\n&#39;, risk_opt);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="下午3小时二次约束规划qcp与鲁棒优化">0.2.3.2. 下午（3小时）：二次约束规划（QCP）与鲁棒优化</h4>
<p><strong>6.3 带二次约束的问题</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 场景：投资组合中，要求90%的置信水平下风险不超过15%

% 数据同上
% 约束中引入二次项
VaR_constraint &#x3D; [x&#39;*cov_matrix*x &lt;&#x3D; 0.15^2];  % 风险约束

Constraints &#x3D; [
    sum(x) &#x3D;&#x3D; 1,
    x &gt;&#x3D; 0,
    returns&#39;*x &gt;&#x3D; 0.12,
    VaR_constraint
];

% Gurobi会自动识别为QCP问题
optimize(Constraints, -returns&#39;*x, ops);  % 最大化收益<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>6.4 鲁棒优化初步（仿射可调鲁棒）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 场景：收益不确定，在±0.02范围内波动，求最坏情况下的最优解

% 定义不确定集
delta &#x3D; sdpvar(10,1);  % 收益波动
Gamma &#x3D; 2;             % 预算不确定参数（控制保守度）

% 鲁棒约束
Robust_Constraints &#x3D; [
    sum(x) &#x3D;&#x3D; 1,
    x &gt;&#x3D; 0,
    (returns+delta)&#39;*x &gt;&#x3D; 0.12,  % 收益约束需满足所有delta
    sum(abs(delta)) &lt;&#x3D; Gamma,    % 不确定预算约束
    -0.02 &lt;&#x3D; delta &lt;&#x3D; 0.02       % 波动范围
];

% YALMIP会自动将鲁棒约束转化为确定性等价形式
optimize(Robust_Constraints, -min((returns+delta)&#39;*x), ops);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第7天第二阶段综合实战与复盘">0.2.4. 第7天：第二阶段综合实战与复盘</h3>
<h4 id="全天6小时完整项目微电网调度">0.2.4.1. 全天（6小时）：完整项目——微电网调度</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 微电网经济调度问题（MILP+QP混合）

% 系统组成：
% - 柴油发电机：成本函数 0.1P² + 5P + 100（二次成本）
% - 光伏：发电成本0，但不确定
% - 电池：充放电效率90%，容量限制
% - 负荷：必须满足

% 预测数据（24小时）
load_profile &#x3D; [50 45 40 38 35 40 55 70 85 90 88 85 82 80 78 75 80 88 92 85 78 70 62 55];
solar_forecast &#x3D; [0 0 0 0 0 5 15 30 45 60 70 75 80 75 65 50 35 20 8 0 0 0 0 0];

%% 参数设置
n &#x3D; 24;  % 24小时调度
P_diesel &#x3D; sdpvar(n,1);  % 柴油发电机功率
P_battery &#x3D; sdpvar(n,1); % 电池充放电（正&#x3D;放电，负&#x3D;充电）
P_grid &#x3D; sdpvar(n,1);    % 主网购售电（正&#x3D;购电，负&#x3D;售电）

SoC &#x3D; sdpvar(n+1,1);     % 电池荷电状态（0-100%）
u_diesel &#x3D; binvar(n,1);  % 柴油机启停状态

% 技术参数
P_diesel_max &#x3D; 100;      % 柴油机最大功率
P_battery_max &#x3D; 50;      % 电池功率限制
SoC_min &#x3D; 0.2; SoC_max &#x3D; 0.9;  % SoC限制
SoC_initial &#x3D; 0.5;       % 初始SoC
battery_eff &#x3D; 0.9;       % 充放电效率
diesel_cost_coeff &#x3D; [0.1, 5, 100];  % 成本系数[a,b,c]对应aP²+bP+c
grid_buy_price &#x3D; 0.8;    % 购电价格
grid_sell_price &#x3D; 0.5;   % 售电价格

%% 约束条件
Constraints &#x3D; [];

% 1. 功率平衡约束（最关键的等式约束）
for t &#x3D; 1:n
    Constraints &#x3D; [Constraints, 
        P_diesel(t) + P_battery(t) + solar_forecast(t) + P_grid(t) &#x3D;&#x3D; load_profile(t)];
end

% 2. 柴油机约束
Constraints &#x3D; [Constraints,
    0 &lt;&#x3D; P_diesel &lt;&#x3D; P_diesel_max*u_diesel,  % 不运行时功率为0
    u_diesel &lt;&#x3D; 1, u_diesel &gt;&#x3D; 0
];

% 3. 电池约束（动力学模型）
Constraints &#x3D; [Constraints,
    -P_battery_max &lt;&#x3D; P_battery &lt;&#x3D; P_battery_max,
    SoC(1) &#x3D;&#x3D; SoC_initial  % 初始荷电状态
];
for t &#x3D; 1:n
    Constraints &#x3D; [Constraints,
        SoC(t+1) &#x3D;&#x3D; SoC(t) - P_battery(t)&#x2F;P_battery_max*battery_eff,
        SoC(t+1) &gt;&#x3D; SoC_min,
        SoC(t+1) &lt;&#x3D; SoC_max
    ];
end

% 4. 主网约束（设双向功率限制）
P_grid_max &#x3D; 200;
Constraints &#x3D; [Constraints, -P_grid_max &lt;&#x3D; P_grid &lt;&#x3D; P_grid_max];

%% 目标函数（分段成本）
% 柴油机成本 &#x3D; 0.1*P² + 5*P + 100*u
diesel_cost &#x3D; diesel_cost_coeff(1)*sum(P_diesel.^2) + ...
              diesel_cost_coeff(2)*sum(P_diesel) + ...
              diesel_cost_coeff(3)*sum(u_diesel);

% 电网交互成本（购电正成本，售电负成本）
grid_cost &#x3D; grid_buy_price*sum(max(P_grid,0)) - grid_sell_price*sum(max(-P_grid,0));

% 总成本
Objective &#x3D; diesel_cost + grid_cost;

%% 求解
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;, &#39;gurobi.TimeLimit&#39;,600, &#39;verbose&#39;,1);
result &#x3D; optimize(Constraints, Objective, ops);

%% 结果分析与绘图
if result.problem &#x3D;&#x3D; 0
    % 提取结果
    P_diesel_opt &#x3D; value(P_diesel);
    P_battery_opt &#x3D; value(P_battery);
    P_grid_opt &#x3D; value(P_grid);
    SoC_opt &#x3D; value(SoC(1:n));  % 取前24小时的
    
    % 绘制调度曲线
    figure(&#39;Position&#39;,[100 100 1200 800]);
    
    subplot(3,1,1);
    plot(1:n, load_profile, &#39;k-&#39;, &#39;LineWidth&#39;,2); hold on;
    plot(1:n, P_diesel_opt, &#39;r--&#39;);
    plot(1:n, solar_forecast, &#39;y:&#39;);
    plot(1:n, P_battery_opt, &#39;b-.&#39;);
    plot(1:n, P_grid_opt, &#39;g--&#39;);
    legend(&#39;负荷&#39;,&#39;柴油机&#39;,&#39;光伏&#39;,&#39;电池&#39;,&#39;主网&#39;);
    title(&#39;功率调度曲线&#39;);
    xlabel(&#39;时间(h)&#39;); ylabel(&#39;功率(kW)&#39;);
    grid on;
    
    subplot(3,1,2);
    stairs(1:n, value(u_diesel), &#39;r-&#39;, &#39;LineWidth&#39;,2);
    title(&#39;柴油机启停状态&#39;);
    ylabel(&#39;状态&#39;); ylim([-0.1 1.1]); grid on;
    
    subplot(3,1,3);
    plot(0:n, value(SoC), &#39;b-o&#39;, &#39;LineWidth&#39;,2);
    title(&#39;电池荷电状态&#39;);
    xlabel(&#39;时间(h)&#39;); ylabel(&#39;SoC(%)&#39;);
    grid on;
    
    % 成本分析
    total_cost &#x3D; value(Objective);
    fprintf(&#39;\n总运行成本: %.2f 元\n&#39;, total_cost);
    fprintf(&#39;柴油机成本: %.2f 元\n&#39;, value(diesel_cost));
    fprintf(&#39;电网交互成本: %.2f 元\n&#39;, value(grid_cost));
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="第三阶段进阶技巧与参数调优第3周">0.3. 第三阶段：进阶技巧与参数调优（第3周）</h2>
<h3 id="第8天大规模问题处理技巧">0.3.1. 第8天：大规模问题处理技巧</h3>
<h4 id="上午3小时稀疏矩阵与向量化编程">0.3.1.1. 上午（3小时）：稀疏矩阵与向量化编程</h4>
<p><strong>8.1 为什么不能用for循环？（性能对比）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% 场景：创建1000个发电机的出力约束
n &#x3D; 1000;
P &#x3D; sdpvar(n,1);
P_max &#x3D; rand(n,1);

%% 方法1：for循环（不推荐）
tic;
Constraints &#x3D; [];
for i &#x3D; 1:n
    Constraints &#x3D; [Constraints, P(i) &lt;&#x3D; P_max(i)];
end
toc;  % 耗时约 0.5-2秒，内存占用高

%% 方法2：向量化（推荐）
tic;
Constraints &#x3D; [P &lt;&#x3D; P_max];  % 一行代码
toc;  % 耗时约 0.01秒，内存占用低

% 性能对比：
% n&#x3D;1000时，方法2快50-200倍
% n&#x3D;10000时，方法1可能内存溢出，方法2依然流畅<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>8.2 稀疏矩阵在电力系统中的应用</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：IEEE 118节点系统（大规模潮流约束）

% 导入系统数据（导纳矩阵）
load(&#39;case118.mat&#39;);  % 包含bus, branch, gen等结构体

nb &#x3D; 118;  % 节点数
ng &#x3D; 54;   % 发电机数

% 决策变量
P_gen &#x3D; sdpvar(ng,1);
V &#x3D; sdpvar(nb,1);  % 电压幅值

% 构建节点功率平衡（稀疏方式）
% 传统稠密矩阵：A &#x3D; zeros(nb,nb); 占用内存 118*118*8 ≈ 105KB
% 稀疏矩阵：A &#x3D; sparse(nb,nb); 占用内存 &lt; 10KB

% 导纳矩阵G和B通常是稀疏的
G &#x3D; sparse(gen_G_matrix);  % 电导矩阵
B &#x3D; sparse(gen_B_matrix);  % 电纳矩阵

% 功率注入表达式（向量化计算）
P_inj &#x3D; V.*(G*V) + V.*(B*V);  % 节点注入功率

% 负荷向量
P_load &#x3D; bus(:,3);  % 第3列是负荷

% 功率平衡（稀疏约束）
Constraints &#x3D; [P_inj &#x3D;&#x3D; P_load + A_gen*P_gen];  % A_gen是稀疏的关联矩阵<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>8.3 参数化的约束生成</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：不同场景下的鲁棒优化

% 定义场景数
n_scenarios &#x3D; 100;
P_load &#x3D; sdpvar(n_scenarios,1);  % 每个场景下的负荷

% 基础约束
Constraints &#x3D; [];
for s &#x3D; 1:n_scenarios
    % 从数据文件读取场景s的负荷
    load_data &#x3D; load([&#39;scenario_&#39;,num2str(s),&#39;.mat&#39;]);
    
    % 参数化约束：根据不同场景调整约束右端项
    Constraints &#x3D; [Constraints, 
        P_gen(s) + P_grid(s) &#x3D;&#x3D; load_data.P_load];
end

% 等价的高效写法（如果需要）：
% 使用cell数组预先生成所有约束
constraint_cell &#x3D; cell(n_scenarios,1);
for s &#x3D; 1:n_scenarios
    constraint_cell&#123;s&#125; &#x3D; (P_gen(s) + P_grid(s) &#x3D;&#x3D; load_data.P_load);
end
Constraints &#x3D; [constraint_cell&#123;:&#125;];<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h4 id="下午3小时求解器日志解读与性能调优">0.3.1.2. 下午（3小时）：求解器日志解读与性能调优</h4>
<p><strong>8.4 Gurobi日志深度解读</strong></p>
<pre class="line-numbers language-none"><code class="language-none">典型日志输出分析：

Optimize a model with 100 rows, 200 columns and 500 nonzeros
Model fingerprint: 0x12345678
Variable types: 150 continuous, 50 integer (50 binary)
Coefficient statistics:
  Matrix range     [1e+00, 1e+03]
  Objective range  [1e-01, 2e+02]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+02, 1e+03]
Presolve removed 25 rows and 50 columns (presolve time &#x3D; 0.05s)...

【解读】
- 100 rows &#x3D; 100个约束
- 200 columns &#x3D; 200个变量
- 500 nonzeros &#x3D; 500个非零系数（稀疏度&#x3D;500&#x2F;(100*200)&#x3D;2.5%）
- Presolve removed：预求解消去了25个冗余约束和50个变量
- 50 binary：50个二元变量 → MILP问题

Presolve time: 0.12s
Presolved: 75 rows, 150 columns, 375 nonzeros

Explored 0 nodes (0 simplex iterations) in 0.05 seconds
Thread count was 8 (of 8 available processors)

Solution count 2: 1234.5 1567.8
Optimal solution found (tolerance 1.00e-04)
Best objective 1.234500000000e+03, best bound 1.234500000000e+03, gap 0.0000%

【解读】
- Explored 0 nodes：根节点就找到了最优解（幸运！）
- Solution count 2：找到2个可行解
- gap 0.0000%：最优性间隙为0，证明全局最优
- Best objective &#x3D; Best bound：上下界重合，最优性得证<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>8.5 性能调优实战案例</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：混合整数规划求解太慢

% 问题：机组组合（Unit Commitment），1440个二元变量
% 目标：24小时调度，最小化成本

% 初始设置（慢，需600秒）
ops_slow &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;);
% optimize(...)  % 600秒

% 调优后设置（快，仅需45秒）
ops_fast &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;gurobi.MIPGap&#39;,0.005,...              % 接受0.5%间隙
    &#39;gurobi.Heuristics&#39;,0.8,...            % 加强启发式
    &#39;gurobi.VarBranch&#39;,3,...               % 最大冲突分支策略
    &#39;gurobi.CutPasses&#39;,5,...               % 增加割平面迭代
    &#39;gurobi.Presolve&#39;,2,...                % 最高级预求解
    &#39;gurobi.NumFocus&#39;,1,...                % 侧重找到可行解
    &#39;gurobi.Threads&#39;,12);                 % 使用更多线程

% 性能提升原理：
% 1. MIPGap放宽：从默认0.01%到0.5%，减少枚举
% 2. Heuristics加强：更快找到优质初始解
% 3. VarBranch策略：选择对目标影响大的变量分支
% 4. Cuts增加：收紧松弛问题，更接近整数解
% 5. 并行加速：12线程 vs 4线程，理论加速3倍（实际约2.5倍）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第9天不可行性诊断与模型修复">0.3.2. 第9天：不可行性诊断与模型修复</h3>
<h4 id="上午3小时冲突约束检测">0.3.2.1. 上午（3小时）：冲突约束检测</h4>
<p><strong>9.1 使用conflict函数定位矛盾</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：模型无可行解，但不知道哪个约束冲突

% 构造一个故意矛盾的模型
x &#x3D; sdpvar(1);
C1 &#x3D; [x &gt;&#x3D; 5];
C2 &#x3D; [x &lt;&#x3D; 3];
C3 &#x3D; [x &#x3D;&#x3D; 4];  % 与前两个矛盾
Constraints &#x3D; [C1, C2, C3];

% 求解
result &#x3D; optimize(Constraints, x, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;));

% 检测冲突
if result.problem &#x3D;&#x3D; 1  % 无可行解
    [conflict_constraints, conflict_flags] &#x3D; conflict(Constraints);
    
    % conflict_flags显示哪些约束参与冲突
    disp(&#39;冲突约束索引:&#39;);
    find(conflict_flags)
    
    % 详细分析
    analyze(conflict_constraints)
end

% 输出示例：
% Conflict set size 2
% Constraint 1:  x &gt;&#x3D; 5
% Constraint 2:  x &lt;&#x3D; 3
% 说明这两个约束直接矛盾，C3是冗余的<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>9.2 软约束（Soft Constraints）与罚函数</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：负荷平衡约束可能无法满足，允许少量切负荷

P_gen &#x3D; sdpvar(10,1);
P_load &#x3D; ones(10,1)*50;  % 预测负荷

% 硬约束（可能导致无解）
% Constraints &#x3D; [sum(P_gen) &#x3D;&#x3D; sum(P_load)];  % 可能不可行

% 软约束（允许偏差，但惩罚）
violation &#x3D; sdpvar(1);  % 偏差变量
penalty_weight &#x3D; 1000;  % 惩罚系数

% 修改约束
Constraints &#x3D; [
    sum(P_gen) + violation &#x3D;&#x3D; sum(P_load),  % 允许偏差
    violation &gt;&#x3D; 0
];

% 目标函数增加惩罚项
Base_Cost &#x3D; sum(P_gen);
Penalty_Cost &#x3D; penalty_weight * violation;
Objective &#x3D; Base_Cost + Penalty_Cost;

% 求解后会优先满足硬约束，软约束尽量满足
optimize(Constraints, Objective, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="下午3小时数值稳定性处理">0.3.2.2. 下午（3小时）：数值稳定性处理</h4>
<p><strong>9.3 数据缩放（Scaling）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：模型系数范围太大导致数值问题

% 原始数据（极差巨大）
coeff &#x3D; [1e-6, 1e3, 1e-3, 1e6];  % 矩阵范围[1e-6,1e6]

% Gurobi会警告：Matrix coefficient range exceeds 1e+06

% 解决方法：缩放
scale_factor &#x3D; 1e3;
coeff_scaled &#x3D; coeff &#x2F; scale_factor;  % 新范围[1e-9,1e3]

% 求解后再反缩放结果
% 或在YALMIP中自动处理：
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.ScaleFlag&#39;,1);
% ScaleFlag&#x3D;1启用自动缩放<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>9.4 大M法的问题与改进</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：逻辑约束中的大M值选择

y &#x3D; binvar(1);
x &#x3D; sdpvar(1);

% 错误做法：M过大导致数值不稳定
M_bad &#x3D; 1e6;
Constraints_bad &#x3D; [x &lt;&#x3D; M_bad*y]; 

% 正确做法：M尽量紧
% 先估算x的最大可能值
x_max &#x3D; 100;  % 基于业务逻辑估算
Constraints_good &#x3D; [x &lt;&#x3D; x_max*y];

% 最佳做法：使用YALMIP的implies（自动避免大M）
Constraints_best &#x3D; [implies(y&#x3D;&#x3D;0, x&#x3D;&#x3D;0), implies(y&#x3D;&#x3D;1, x&gt;&#x3D;0)];
% YALMIP会生成Gurobi的indicator约束，无需手动大M<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第10天结果后处理与可视化">0.3.3. 第10天：结果后处理与可视化</h3>
<h4 id="上午2小时提取对偶变量与灵敏度分析">0.3.3.1. 上午（2小时）：提取对偶变量与灵敏度分析</h4>
<p><strong>10.1 对偶变量（Shadow Price）的经济学意义</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：电力系统节点电价计算

% 节点功率平衡约束
P_inj &#x3D; sdpvar(n,1);  % 节点注入
P_load &#x3D; bus(:,3);    % 节点负荷
Gen_incidence &#x3D; ...;  % 发电机-节点关联矩阵

% 约束
Constraints &#x3D; [P_inj &#x3D;&#x3D; P_load + Gen_incidence*P_gen];

% 求解
optimize(Constraints, Cost, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;));

% 提取对偶变量（节点电价）
if result.problem &#x3D;&#x3D; 0
    nodal_price &#x3D; dual(Constraints);  % 每个节点的影子价格
    % 对偶变量表示该节点每增加1MW负荷，总成本增加量（$&#x2F;MW）
    
    % 绘制电价地图
    figure;
    scatter(bus(:,2), bus(:,3), 100, nodal_price, &#39;filled&#39;);
    colorbar;
    title(&#39;节点电价分布&#39;);
    xlabel(&#39;经度&#39;); ylabel(&#39;纬度&#39;);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>10.2 参数灵敏度分析</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：天然气价格变化对机组调度影响

gas_price_range &#x3D; 2:0.5:5;  % 天然气价格范围（$&#x2F;MMBtu）
total_cost_curve &#x3D; zeros(size(gas_price_range));

for i &#x3D; 1:length(gas_price_range)
    % 重新计算目标函数（系数含gas_price）
    gas_price &#x3D; gas_price_range(i);
    Fuel_Cost &#x3D; gas_price * Heat_Rate * P_gen;
    
    % 求解
    optimize(Constraints, Fuel_Cost, ops);
    
    if result.problem &#x3D;&#x3D; 0
        total_cost_curve(i) &#x3D; value(Fuel_Cost);
    end
end

% 绘制成本曲线
plot(gas_price_range, total_cost_curve, &#39;-o&#39;);
xlabel(&#39;天然气价格 ($&#x2F;MMBtu)&#39;);
ylabel(&#39;总运行成本 ($)&#39;);
title(&#39;价格灵敏度分析&#39;);
grid on;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="下午2小时结果可视化高级技巧">0.3.3.2. 下午（2小时）：结果可视化高级技巧</h4>
<p><strong>10.3 Gantt图（调度问题必备）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：5台机组24小时启停计划

% 求解后得到u_on矩阵（5台×24小时）
u_on_opt &#x3D; value(u_on);  % 5×24的二元矩阵

% 绘制Gantt图
figure(&#39;Position&#39;,[100 100 1200 400]);
y_tics &#x3D; 1:5;
for i &#x3D; 1:5
    on_periods &#x3D; find(u_on_opt(i,:)&#x3D;&#x3D;1);
    if ~isempty(on_periods)
        for t &#x3D; on_periods
            x_start &#x3D; t-1;
            y_bottom &#x3D; i-0.3;
            rectangle(&#39;Position&#39;,[x_start,y_bottom,1,0.6],...
                     &#39;FaceColor&#39;,[0.2 0.6 0.9],...
                     &#39;EdgeColor&#39;,&#39;none&#39;);
        end
    end
end

xlim([0 24]);
ylim([0.5 5.5]);
set(gca,&#39;YTick&#39;,y_tics,&#39;YTickLabel&#39;,&#123;&#39;G1&#39;,&#39;G2&#39;,&#39;G3&#39;,&#39;G4&#39;,&#39;G5&#39;&#125;);
xlabel(&#39;时间 (h)&#39;);
ylabel(&#39;机组&#39;);
title(&#39;机组启停计划甘特图&#39;);
grid on;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>10.4 3D曲面图（展示多参数影响）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：电池容量 vs 光伏容量 对系统成本影响

battery_cap_range &#x3D; 0:10:100;  % 电池容量范围
solar_cap_range &#x3D; 0:5:50;      % 光伏容量范围
cost_matrix &#x3D; zeros(length(battery_cap_range), length(solar_cap_range));

for i &#x3D; 1:length(battery_cap_range)
    for j &#x3D; 1:length(solar_cap_range)
        % 重新设置容量参数
        battery_capacity &#x3D; battery_cap_range(i);
        solar_capacity &#x3D; solar_cap_range(j);
        
        % 更新约束（电池容量约束）
        Constraints &#x3D; [SoC &lt;&#x3D; battery_capacity&#x2F;1000, ...];
        
        % 求解
        optimize(Constraints, Objective, ops);
        
        if result.problem &#x3D;&#x3D; 0
            cost_matrix(i,j) &#x3D; value(Objective);
        end
    end
end

% 绘制3D曲面
[B,S] &#x3D; meshgrid(solar_cap_range, battery_cap_range);
surf(B,S,cost_matrix&#x2F;1e6);
xlabel(&#39;光伏容量 (MW)&#39;);
ylabel(&#39;电池容量 (MWh)&#39;);
zlabel(&#39;年化成本 (百万元)&#39;);
title(&#39;容量配置优化分析&#39;);
colorbar;
shading interp;  % 平滑着色<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="第四阶段综合项目实战第4周">0.4. 第四阶段：综合项目实战（第4周）</h2>
<h3 id="第11天电力系统机组组合问题unit-commitment">0.4.1. 第11天：电力系统——机组组合问题（Unit
Commitment）</h3>
<h4 id="全天6小时ieee-30节点系统uc问题">0.4.1.1. 全天（6小时）：IEEE
30节点系统UC问题</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% IEEE 30节点系统机组组合问题（完整工业级代码）

clear; clc; close all;

%% 1. 系统数据加载
% 数据包括：机组参数、负荷曲线、网络参数
load(&#39;case30data.mat&#39;);  % 假设已准备好

n_gen &#x3D; 6;    % 6台发电机
n_hour &#x3D; 24;  % 24小时调度

% 机组参数（通常从Excel读取）
gen_param &#x3D; [
    10 20 100 50 0.1 0.2 5 100;  % [Pmin Pmax a b c start_cost min_down min_up]
    20 50 150 80 0.08 0.15 8 120;
    15 35 120 60 0.09 0.18 6 110;
    12 40 130 70 0.11 0.22 7 130;
    18 45 140 75 0.12 0.24 9 140;
    25 60 160 90 0.13 0.26 10 150
];

P_min &#x3D; gen_param(:,1);
P_max &#x3D; gen_param(:,2);
cost_a &#x3D; gen_param(:,3);
cost_b &#x3D; gen_param(:,4);
cost_c &#x3D; gen_param(:,5);
start_cost &#x3D; gen_param(:,6);
min_down &#x3D; gen_param(:,7);
min_up &#x3D; gen_param(:,8);

% 24小时负荷曲线（MW）
load_curve &#x3D; 100*[2.4 2.3 2.2 2.1 2.0 2.1 2.3 2.8 3.2 3.5 3.6 3.4 3.2 3.0 3.1 3.3 3.5 3.8 3.6 3.4 3.2 2.9 2.6 2.5];

%% 2. 决策变量定义
P &#x3D; sdpvar(n_gen, n_hour);      % 发电功率
u &#x3D; binvar(n_gen, n_hour);      % 启停状态
v_start &#x3D; binvar(n_gen, n_hour); % 启动变量
v_shutdown &#x3D; binvar(n_gen, n_hour); % 停机变量

%% 3. 约束条件
Constraints &#x3D; [];

% 3.1 功率平衡（每个小时）
for t &#x3D; 1:n_hour
    Constraints &#x3D; [Constraints, 
        sum(P(:,t)) &#x3D;&#x3D; load_curve(t)];
end

% 3.2 机组出力限制
for t &#x3D; 1:n_hour
    for g &#x3D; 1:n_gen
        Constraints &#x3D; [Constraints,
            P(g,t) &gt;&#x3D; P_min(g)*u(g,t),
            P(g,t) &lt;&#x3D; P_max(g)*u(g,t)
        ];
    end
end

% 3.3 最小启停时间约束（逻辑复杂，需仔细）
% 假设初始状态：已运行3小时
initial_status &#x3D; ones(n_gen,1);
initial_runtime &#x3D; 3*ones(n_gen,1);

% 启动&#x2F;停机变量定义
for g &#x3D; 1:n_gen
    for t &#x3D; 1:n_hour
        if t &#x3D;&#x3D; 1
            Constraints &#x3D; [Constraints,
                v_start(g,t) &gt;&#x3D; u(g,t) - initial_status(g),
                v_shutdown(g,t) &gt;&#x3D; initial_status(g) - u(g,t)
            ];
        else
            Constraints &#x3D; [Constraints,
                v_start(g,t) &gt;&#x3D; u(g,t) - u(g,t-1),
                v_shutdown(g,t) &gt;&#x3D; u(g,t-1) - u(g,t)
            ];
        end
        Constraints &#x3D; [Constraints,
            v_start(g,t) &lt;&#x3D; u(g,t),
            v_shutdown(g,t) &lt;&#x3D; 1 - u(g,t)
        ];
    end
end

% 最小运行&#x2F;停机时间
for g &#x3D; 1:n_gen
    for t &#x3D; 1:n_hour
        % 最小运行时间
        for tau &#x3D; max(1,t-min_up(g)+1):t
            Constraints &#x3D; [Constraints,
                u(g,t) &lt;&#x3D; sum(v_start(g,tau:t)) + (initial_runtime(g) &gt;&#x3D; min_up(g))];
        end
        
        % 最小停机时间
        for tau &#x3D; max(1,t-min_down(g)+1):t
            Constraints &#x3D; [Constraints,
                1-u(g,t) &lt;&#x3D; sum(v_shutdown(g,tau:t)) + (initial_status(g)&#x3D;&#x3D;0)];
        end
    end
end

%% 4. 目标函数
Generation_Cost &#x3D; 0;
Start_Cost &#x3D; 0;

for g &#x3D; 1:n_gen
    for t &#x3D; 1:n_hour
        Generation_Cost &#x3D; Generation_Cost + ...
            cost_c(g)*P(g,t)^2 + cost_b(g)*P(g,t) + cost_a(g)*u(g,t);
        Start_Cost &#x3D; Start_Cost + start_cost(g)*v_start(g,t);
    end
end

Objective &#x3D; Generation_Cost + Start_Cost;

%% 5. 求解设置与运行
ops &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;verbose&#39;,1,...
    &#39;gurobi.MIPGap&#39;,0.01,...          % 1%间隙
    &#39;gurobi.TimeLimit&#39;,1800,...       % 30分钟
    &#39;gurobi.MIPFocus&#39;,1,...           % 重点找可行解
    &#39;gurobi.Heuristics&#39;,0.8);        % 强化启发式

% 添加初始解（暖启动）
% 假设全部机组以最小出力运行
P_init &#x3D; repmat(P_min, 1, n_hour);
u_init &#x3D; ones(n_gen, n_hour);
ops &#x3D; sdpsettings(ops,&#39;gurobi.Start&#39;,struct(&#39;P&#39;,P_init,&#39;u&#39;,u_init));

% 求解
tic;
result &#x3D; optimize(Constraints, Objective, ops);
solve_time &#x3D; toc;

%% 6. 结果分析与验证
if result.problem &#x3D;&#x3D; 0
    P_opt &#x3D; value(P);
    u_opt &#x3D; value(u);
    v_start_opt &#x3D; value(v_start);
    
    total_cost &#x3D; value(Objective);
    
    fprintf(&#39;\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; 机组组合求解成功 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n&#39;);
    fprintf(&#39;求解时间: %.2f 秒\n&#39;, solve_time);
    fprintf(&#39;总成本: $%.2f\n&#39;, total_cost);
    
    % 绘制调度曲线
    figure(&#39;Position&#39;,[100 100 1400 800]);
    
    % 发电堆叠图
    subplot(2,1,1);
    area(1:n_hour, P_opt&#39;, &#39;LineStyle&#39;,&#39;none&#39;);
    hold on;
    plot(1:n_hour, load_curve, &#39;k-&#39;, &#39;LineWidth&#39;,2);
    legend(&#39;G1&#39;,&#39;G2&#39;,&#39;G3&#39;,&#39;G4&#39;,&#39;G5&#39;,&#39;G6&#39;,&#39;负荷&#39;);
    title(&#39;机组出力曲线&#39;);
    xlabel(&#39;时间(h)&#39;); ylabel(&#39;功率(MW)&#39;);
    grid on;
    
    % 启停状态图
    subplot(2,1,2);
    imagesc(1:n_hour, 1:n_gen, u_opt);
    set(gca,&#39;YTick&#39;,1:n_gen,&#39;YTickLabel&#39;,&#123;&#39;G1&#39;,&#39;G2&#39;,&#39;G3&#39;,&#39;G4&#39;,&#39;G5&#39;,&#39;G6&#39;&#125;);
    xlabel(&#39;时间(h)&#39;); ylabel(&#39;机组&#39;);
    title(&#39;启停状态（蓝色&#x3D;运行）&#39;);
    colorbar;
    
    % 成本构成分析
    gen_cost_val &#x3D; value(Generation_Cost);
    start_cost_val &#x3D; value(Start_Cost);
    
    figure;
    pie([gen_cost_val, start_cost_val], &#123;&#39;发电成本&#39;,&#39;启停成本&#39;&#125;);
    title(&#39;成本构成&#39;);
else
    error(&#39;机组组合求解失败，错误代码: %d&#39;, result.problem);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第12天控制工程模型预测控制mpc">0.4.2. 第12天：控制工程——模型预测控制（MPC）</h3>
<h4 id="全天6小时mpc完整实现">0.4.2.1. 全天（6小时）：MPC完整实现</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 线性MPC控制器设计（以双积分系统为例）

% 系统模型：x(k+1) &#x3D; A*x(k) + B*u(k)
% 状态：x &#x3D; [位置;速度]
% 控制输入：u &#x3D; 加速度

%% 1. 系统参数
Ts &#x3D; 0.1;  % 采样时间(s)
A &#x3D; [1 Ts; 0 1];  % 离散状态矩阵
B &#x3D; [0.5*Ts^2; Ts];  % 离散输入矩阵

nx &#x3D; 2;  % 状态数
nu &#x3D; 1;  % 控制输入数

% 约束
u_min &#x3D; -5; u_max &#x3D; 5;  % 加速度限制
x_max &#x3D; [10; 5];        % 位置和速度限制

% MPC参数
N &#x3D; 20;  % 预测时域
Q &#x3D; eye(nx);  % 状态权重
R &#x3D; 0.1;      % 输入权重

%% 2. 决策变量定义
X &#x3D; sdpvar(nx, N+1);  % 预测时域内所有状态
U &#x3D; sdpvar(nu, N);    % 预测时域内所有输入

x0 &#x3D; sdpvar(nx,1);    % 当前状态（已知参数）

%% 3. MPC模型约束
Constraints &#x3D; [];

% 初始条件
Constraints &#x3D; [X(:,1) &#x3D;&#x3D; x0];

% 系统动力学（对每个预测步）
for k &#x3D; 1:N
    Constraints &#x3D; [Constraints, 
        X(:,k+1) &#x3D;&#x3D; A*X(:,k) + B*U(:,k)];
end

% 状态约束
for k &#x3D; 1:N+1
    Constraints &#x3D; [Constraints, 
        -x_max &lt;&#x3D; X(:,k) &lt;&#x3D; x_max];
end

% 输入约束
for k &#x3D; 1:N
    Constraints &#x3D; [Constraints, 
        u_min &lt;&#x3D; U(:,k) &lt;&#x3D; u_max];
end

%% 4. 目标函数
Objective &#x3D; 0;
for k &#x3D; 1:N
    Objective &#x3D; Objective + X(:,k)&#39;*Q*X(:,k) + R*U(:,k)^2;
end
% 终端代价
Objective &#x3D; Objective + X(:,N+1)&#39;*Q*X(:,N+1);

%% 5. 创建MPC求解器（离线编译）
% 将x0作为参数
Controller &#x3D; optimizer(Constraints, Objective, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;), x0, U(:,1));

%% 6. 仿真闭环控制
sim_time &#x3D; 50;  % 仿真步数
x_current &#x3D; [5; 0];  % 初始状态[位置;速度]
x_history &#x3D; zeros(nx, sim_time);
u_history &#x3D; zeros(nu, sim_time);

for t &#x3D; 1:sim_time
    % 求解MPC（在线计算）
    u_opt &#x3D; Controller&#123;x_current&#125;;
    
    % 应用第一个控制输入
    u_current &#x3D; value(u_opt);
    
    % 记录
    x_history(:,t) &#x3D; x_current;
    u_history(:,t) &#x3D; u_current;
    
    % 模拟系统演化（真实系统）
    x_current &#x3D; A*x_current + B*u_current;
    
    % 可视化
    clf;
    subplot(2,1,1);
    plot(1:t, x_history(1,1:t), &#39;b-&#39;, &#39;LineWidth&#39;,2);
    hold on;
    plot(t, x_current(1), &#39;ro&#39;);
    title(&#39;位置轨迹&#39;); xlabel(&#39;步数&#39;); ylabel(&#39;位置&#39;);
    grid on;
    
    subplot(2,1,2);
    stairs(1:t, u_history(:,1:t), &#39;r-&#39;, &#39;LineWidth&#39;,2);
    title(&#39;控制输入&#39;); xlabel(&#39;步数&#39;); ylabel(&#39;加速度&#39;);
    grid on;
    ylim([u_min u_max]);
    
    drawnow;
    pause(0.1);
end

%% 7. 性能分析
figure;
subplot(2,1,1);
plot(x_history(1,:), x_history(2,:), &#39;b-&#39;, &#39;LineWidth&#39;,2);
title(&#39;状态相轨迹&#39;);
xlabel(&#39;位置&#39;); ylabel(&#39;速度&#39;);
grid on;

subplot(2,1,2);
plot(u_history, &#39;r-&#39;, &#39;LineWidth&#39;,2);
title(&#39;控制输入时序&#39;);
xlabel(&#39;步数&#39;); ylabel(&#39;加速度&#39;);
grid on;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第13天路径规划与旅行商问题tsp">0.4.3. 第13天：路径规划与旅行商问题（TSP）</h3>
<h4 id="全天6小时tsp建模与求解">0.4.3.1. 全天（6小时）：TSP建模与求解</h4>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 旅行商问题（TSP）—— 经典组合优化

% 问题：访问10个城市，每个城市一次，返回起点，路程最短

% 城市坐标
cities &#x3D; [
    0 0; 10 0; 5 8.66; 15 8.66; 20 0;
    25 8.66; 30 0; 35 8.66; 40 0; 45 8.66
];
n &#x3D; size(cities,1);

% 计算距离矩阵D(i,j)
D &#x3D; zeros(n,n);
for i &#x3D; 1:n
    for j &#x3D; 1:n
        D(i,j) &#x3D; norm(cities(i,:) - cities(j,:));
    end
end

%% 1. Miller-Tucker-Zemlin (MTZ) 建模法
% 决策变量：x(i,j)&#x3D;1表示路径i→j
x &#x3D; binvar(n,n,&#39;full&#39;);  % &#39;full&#39;表示非对称

% 辅助变量：u(i)用于消除子回路
u &#x3D; sdpvar(n,1);

% 约束
Constraints &#x3D; [];

% 每个城市恰好一次入边和出边
Constraints &#x3D; [Constraints, sum(x,1)&#39; &#x3D;&#x3D; 1];  % 出度&#x3D;1
Constraints &#x3D; [Constraints, sum(x,2) &#x3D;&#x3D; 1];   % 入度&#x3D;1

% 消除子回路（MTZ约束）
M &#x3D; n;  % 大M
for i &#x3D; 2:n
    for j &#x3D; 2:n
        if i ~&#x3D; j
            Constraints &#x3D; [Constraints, u(i) - u(j) + M*x(i,j) &lt;&#x3D; M-1];
        end
    end
end

% 固定起点（城市1）
Constraints &#x3D; [Constraints, x(1,1) &#x3D;&#x3D; 0];  % 不自我连接

% 目标函数
Objective &#x3D; sum(sum(D.*x));

%% 2. 求解（TSP是MILP，Gurobi强项）
ops &#x3D; sdpsettings(...
    &#39;solver&#39;,&#39;gurobi&#39;,...
    &#39;verbose&#39;,1,...
    &#39;gurobi.MIPGap&#39;,0.001,...      % 0.1%精度
    &#39;gurobi.Heuristics&#39;,0.8,...    % 强化启发式
    &#39;gurobi.CutPasses&#39;,5);         % 加强割平面

result &#x3D; optimize(Constraints, Objective, ops);

%% 3. 结果可视化
if result.problem &#x3D;&#x3D; 0
    x_opt &#x3D; value(x);
    
    % 提取路径
    tour &#x3D; zeros(1,n+1);
    tour(1) &#x3D; 1;  % 起点
    for i &#x3D; 2:n+1
        next_city &#x3D; find(x_opt(tour(i-1),:) &gt; 0.5);
        tour(i) &#x3D; next_city;
    end
    
    % 绘制路径图
    figure(&#39;Position&#39;,[100 100 800 600]);
    plot(cities(:,1), cities(:,2), &#39;ko&#39;, &#39;MarkerSize&#39;,10, &#39;LineWidth&#39;,2);
    hold on;
    
    % 绘制路线
    plot(cities(tour,1), cities(tour,2), &#39;b-&#39;, &#39;LineWidth&#39;,2);
    plot([cities(tour(end),1), cities(tour(1),1)],...
         [cities(tour(end),2), cities(tour(1),2)], &#39;b-&#39;, &#39;LineWidth&#39;,2);
    
    % 标注城市
    for i &#x3D; 1:n
        text(cities(i,1), cities(i,2)+1, sprintf(&#39;C%d&#39;,i),...
            &#39;HorizontalAlignment&#39;,&#39;center&#39;);
    end
    
    title(sprintf(&#39;TSP最优路径 (距离&#x3D;%.2f)&#39;, value(Objective)));
    xlabel(&#39;X坐标&#39;);
    ylabel(&#39;Y坐标&#39;);
    grid on;
    axis equal;
    
    % 绘制时间序列（如果是动态TSP）
    figure;
    plot(1:n+1, tour, &#39;b-o&#39;, &#39;LineWidth&#39;,2);
    yticks(1:n);
    title(&#39;访问顺序&#39;);
    xlabel(&#39;步骤&#39;);
    ylabel(&#39;城市编号&#39;);
    grid on;
else
    error(&#39;TSP求解失败&#39;);
end

%% 4. 对比：使用Gurobi的预热启动（Warm Start）
% 提供初始可行解（如最近邻启发式）
initial_tour &#x3D; nearest_neighbor_tour(cities); % 自定义函数
x_initial &#x3D; zeros(n,n);
for k &#x3D; 1:n-1
    x_initial(initial_tour(k), initial_tour(k+1)) &#x3D; 1;
end
x_initial(initial_tour(n), initial_tour(1)) &#x3D; 1;

% 设置初始解
ops_warm &#x3D; sdpsettings(ops, &#39;gurobi.Start&#39;, struct(&#39;x&#39;,x_initial));

% 再次求解
tic;
result_warm &#x3D; optimize(Constraints, Objective, ops_warm);
time_warm &#x3D; toc;

fprintf(&#39;\n预热启动效果:\n&#39;);
fprintf(&#39;原求解时间: %.2f秒\n&#39;, result.solverinfo.solvetime);
fprintf(&#39;预热后时间: %.2f秒\n&#39;, time_warm);
fprintf(&#39;加速比: %.2f%%\n&#39;, (1-time_warm&#x2F;result.solverinfo.solvetime)*100);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第14天考试与项目答辩">0.4.4. 第14天：考试与项目答辩</h3>
<h4 id="全天6小时模拟项目答辩">0.4.4.1. 全天（6小时）：模拟项目答辩</h4>
<p><strong>14.1 答辩题目（随机抽取）</strong></p>
<pre class="line-numbers language-none"><code class="language-none">题目1：微电网调度优化
- 需求：设计一个含5台柴油发电机、2个储能、光伏和负荷的微电网日前调度模型
- 约束：功率平衡、机组爬坡、储能动力学、旋转备用
- 目标：最小化运行成本
- 要求：提交代码、结果曲线、经济性分析报告

题目2：无人机路径规划
- 需求：5架无人机从基地出发，访问20个目标点，返回基地
- 约束：每架无人机航程&lt;50km，避障（禁飞区），时间窗
- 目标：最小化总航程
- 要求：3D可视化路径，冲突检测分析

题目3：智能制造排程
- 需求：10台机器，20个订单，每个订单多道工序
- 约束：机器能力、工序先后、交付时间窗
- 目标：最小化延迟交付惩罚
- 要求：Gantt图，机器利用率分析<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>14.2 评分标准</strong></p>
<table>
<thead>
<tr class="header">
<th>维度</th>
<th>权重</th>
<th>评分细则</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>模型正确性</strong></td>
<td>40%</td>
<td>约束完整、逻辑正确、变量定义合理</td>
</tr>
<tr class="even">
<td><strong>代码质量</strong></td>
<td>30%</td>
<td>结构化、注释清晰、矩阵化（无for循环）</td>
</tr>
<tr class="odd">
<td><strong>结果分析</strong></td>
<td>20%</td>
<td>可视化专业、灵敏度分析、经济性评估</td>
</tr>
<tr class="even">
<td><strong>创新性</strong></td>
<td>10%</td>
<td>额外功能（如鲁棒性、多目标）</td>
</tr>
</tbody>
</table>
<p><strong>14.3 项目报告模板</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 项目报告生成脚本（自动生成Word&#x2F;PDF）

% 1. 设置报告模板
import mlreportgen.report.*;
import mlreportgen.dom.*;

rpt &#x3D; Report(&#39;optimization_project&#39;,&#39;pdf&#39;);

% 2. 添加标题页
tp &#x3D; TitlePage();
tp.Title &#x3D; &#39;微电网经济调度优化项目&#39;;
tp.Author &#x3D; &#39;学习者&#39;;
tp.Date &#x3D; date;
add(rpt,tp);

% 3. 添加问题描述
chapter1 &#x3D; Chapter(&#39;问题描述&#39;);
add(chapter1, Paragraph(&#39;本研究考虑一个含...&#39;));
add(rpt, chapter1);

% 4. 添加数学模型
chapter2 &#x3D; Chapter(&#39;数学模型&#39;);
eq1 &#x3D; FormalEq(&#39;$min \sum_&#123;t&#x3D;1&#125;^&#123;24&#125; \sum_&#123;g&#x3D;1&#125;^&#123;6&#125; (a_g P_&#123;g,t&#125;^2 + b_g P_&#123;g,t&#125; + c_g u_&#123;g,t&#125;)$&#39;);
add(chapter2, eq1);
add(rpt, chapter2);

% 5. 添加代码
chapter3 &#x3D; Chapter(&#39;MATLAB实现&#39;);
code &#x3D; ProgrammaticCode(which(&#39;microgrid_uc.m&#39;));
add(chapter3, code);
add(rpt, chapter3);

% 6. 添加结果图
chapter4 &#x3D; Chapter(&#39;结果分析&#39;);
fig &#x3D; Figure();
fig.Snapshot &#x3D; &#39;results_figure1.png&#39;;
add(chapter4, fig);
add(rpt, chapter4);

% 7. 生成报告
close(rpt);
rptview(rpt);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="第五阶段避坑指南与进阶学习第4周补充">0.5. 第五阶段：避坑指南与进阶学习（第4周补充）</h2>
<h3 id="第15天新手必踩的100个坑精选top-20">0.5.1. 第15天：新手必踩的100个坑（精选TOP
20）</h3>
<h4 id="上午3小时代码级错误">0.5.1.1. 上午（3小时）：代码级错误</h4>
<p><strong>TOP 1-5：变量类型混淆</strong> <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% ❌ 错误1：数值变量和sdpvar混用
x &#x3D; sdpvar(1);
if x &gt; 0  % 错误！x是符号变量，不能用于逻辑判断
    y &#x3D; 1;
end

% ✅ 正确：用YALMIP的逻辑约束
y &#x3D; binvar(1);
Constraints &#x3D; [implies(x&gt;&#x3D;0, y&#x3D;&#x3D;1), implies(x&lt;0, y&#x3D;&#x3D;0)];

% ❌ 错误2：赋值与约束混淆
x &#x3D; sdpvar(1);
x &#x3D; 5;  % 这是赋值，不是约束！x不再是sdpvar

% ✅ 正确：
Constraints &#x3D; [x &#x3D;&#x3D; 5];

% ❌ 错误3：使用非线性函数
x &#x3D; sdpvar(1);
obj &#x3D; sin(x);  % 错误！YALMIP不支持sin

% ✅ 正确：用分段线性近似
obj &#x3D; pwlf(x, [-pi -pi&#x2F;2 0 pi&#x2F;2 pi], [-1 0 1 0 -1]);  % 近似sin(x)

% ❌ 错误4：矩阵乘法维度错误
x &#x3D; sdpvar(3,1);
A &#x3D; rand(2,3);
obj &#x3D; x&#39;*A*x;  % 错误！x&#39;是1×3，A是2×3

% ✅ 正确：
obj &#x3D; x&#39;*(A&#39;*A)*x;  % A&#39;*A是3×3
% 或
obj &#x3D; sum((A*x).^2);

% ❌ 错误5：未初始化的约束数组
Constraints &#x3D; [];  % 正确初始化
for i &#x3D; 1:10
    Constraints &#x3D; [Constraints, x(i) &lt;&#x3D; i];  % 逐个添加
end
% 如果忘记初始化：Constraints未定义，报错<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<p><strong>TOP 6-10：求解器设置错误</strong> <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% ❌ 错误6：求解器名称拼写错误
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;);  % 正确
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;Gurobi&#39;);  % 错误！大小写敏感

% ❌ 错误7：参数名称错误
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;MIPGap&#39;,0.01);  % 错误！应加前缀
% ✅ 正确：
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.MIPGap&#39;,0.01);

% ❌ 错误8：设置了求解器不支持的参数
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;barrier_iterations&#39;,100);
% Gurobi没有barrier_iterations参数，正确的是&#39;gurobi.BarIterLimit&#39;

% ❌ 错误9：时间单位混淆
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.TimeLimit&#39;,100);
% 单位是秒！设置为100以为100分钟，实际是100秒

% ❌ 错误10：verbose和OutputFlag混淆
sdpsettings(&#39;verbose&#39;,0)  % 抑制YALMIP输出
sdpsettings(&#39;gurobi.OutputFlag&#39;,0)  % 抑制Gurobi输出
% 两者都要设才能完全静默<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<h4 id="下午3小时建模级错误">0.5.1.2. 下午（3小时）：建模级错误</h4>
<p><strong>TOP 11-15：约束建模错误</strong> <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% ❌ 错误11：严格不等式
Constraints &#x3D; [x &gt; 0];  % 错误！MILP不支持严格不等式
% ✅ 正确：
epsilon &#x3D; 1e-6;
Constraints &#x3D; [x &gt;&#x3D; epsilon];  % 或x &gt;&#x3D; 0（如果允许零）

% ❌ 错误12：双向约束写错
% 意图：10 &lt;&#x3D; x &lt;&#x3D; 20
Constraints &#x3D; [10 &lt;&#x3D; x &lt;&#x3D; 20];  % MATLAB解析错误
% ✅ 正确：
Constraints &#x3D; [10 &lt;&#x3D; x, x &lt;&#x3D; 20];

% ❌ 错误13：非凸二次约束
x &#x3D; sdpvar(2,1);
Constraints &#x3D; [x&#39;*[1 0;0 -1]*x &gt;&#x3D; 0];  % 非凸！Gurobi报错
% 解决方案：用Cplex或Bonmin求解器，或改写约束

% ❌ 错误14：循环约束索引错误
x &#x3D; sdpvar(10,1);
Constraints &#x3D; [];
for i &#x3D; 1:10
    Constraints &#x3D; [Constraints, x(i) &lt;&#x3D; x(i+1)];  % i+1&#x3D;11越界！
end
% ✅ 正确：
for i &#x3D; 1:9
    Constraints &#x3D; [Constraints, x(i) &lt;&#x3D; x(i+1)];
end

% ❌ 错误15：使用绝对值导致非线性
x &#x3D; sdpvar(1);
obj &#x3D; abs(x);  % 这不是线性！
% ✅ 正确：引入辅助变量
y &#x3D; sdpvar(1);
Constraints &#x3D; [y &gt;&#x3D; x, y &gt;&#x3D; -x];
obj &#x3D; y;  % 最小化y等价于最小化|x|<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<p><strong>TOP 16-20：算法与理论错误</strong> <pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">% ❌ 错误16：QP问题Q矩阵非正定
Q &#x3D; [1 2; 2 1];  % 特征值&#x3D;-1,3，非正定
x &#x3D; sdpvar(2,1);
obj &#x3D; x&#39;*Q*x;  % Gurobi警告&quot;Q matrix is not positive semi-definite&quot;
% 解决方案：Q &#x3D; 0.5*(Q+Q&#39;) + epsilon*eye(n); 强制对称正定

% ❌ 错误17：未检查求解状态直接使用结果
result &#x3D; optimize(C,obj,ops);
x_opt &#x3D; value(x);  % 如果求解失败，value返回NaN
% ✅ 正确：
if result.problem &#x3D;&#x3D; 0
    x_opt &#x3D; value(x);
else
    error(&#39;求解未成功，结果无效&#39;);
end

% ❌ 错误18：MILP问题设置了连续算法
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.Method&#39;,0);  % 对MILP，Method只在根节点有效
% 对MILP，主要控制分支定界的是&#39;MIPFocus&#39;、&#39;Heuristics&#39;等

% ❌ 错误19：混合精度问题
% 数据：load &#x3D; 100.000000000001（CSV导入产生的微小误差）
% 约束：sum(gen) &#x3D;&#x3D; load
% 结果：可行解可能因数值误差被判为不可行
% ✅ 正确：
load &#x3D; round(load, 6);  % 保留6位小数
% 或设置容差：
ops &#x3D; sdpsettings(&#39;gurobi.FeasibilityTol&#39;,1e-5);

% ❌ 错误20：未使用暖启动重复求解
% 场景：滚动优化中，每次从头求解
for k &#x3D; 1:100
    optimize(C,obj,ops);  % 每次都冷启动，慢！
end
% ✅ 正确：利用前次解
x_previous &#x3D; [];
for k &#x3D; 1:100
    if ~isempty(x_previous)
        ops.Start &#x3D; x_previous;  % 暖启动
    end
    result &#x3D; optimize(C,obj,ops);
    x_previous &#x3D; value(x);  % 保存当前解
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<hr>
<h3 id="第16天进阶主题与前沿技术">0.5.2. 第16天：进阶主题与前沿技术</h3>
<h4 id="上午3小时鲁棒优化与分布鲁棒">0.5.2.1. 上午（3小时）：鲁棒优化与分布鲁棒</h4>
<p><strong>16.1 经典鲁棒优化（Box Uncertainty）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：需求不确定，在±10%范围内波动

P_load_nominal &#x3D; 100;  % 标称负荷
uncertainty &#x3D; 0.1;     % 10%波动

% 传统确定性优化
P_gen &#x3D; sdpvar(1);
Constraints_det &#x3D; [P_gen &#x3D;&#x3D; P_load_nominal];
optimize(Constraints_det, P_gen^2);

% 鲁棒优化（最坏情况）
delta &#x3D; sdpvar(1);  % 不确定性变量
Constraints_robust &#x3D; [
    P_gen &gt;&#x3D; P_load_nominal + delta,  % 必须覆盖最坏情况
    -uncertainty*P_load_nominal &lt;&#x3D; delta &lt;&#x3D; uncertainty*P_load_nominal
];
optimize(Constraints_robust, P_gen^2);  % 最大化最坏情况下的性能<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>16.2 分布鲁棒优化（Wasserstein球）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：基于历史数据的分布鲁棒

% 假设有100个历史负荷场景
load_scenarios &#x3D; load_data_hist;  % 100×1向量

% Wasserstein球半径
epsilon &#x3D; 0.1;

% 定义概率分布变量
p &#x3D; sdpvar(100,1);
Constraints &#x3D; [
    p &gt;&#x3D; 0,
    sum(p) &#x3D;&#x3D; 1
];

% 构造分布鲁棒约束（较复杂，需对偶转换）
% YALMIP的distribute函数可简化
% 此处为概念性代码<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="下午3小时多目标优化与帕累托前沿">0.5.2.2. 下午（3小时）：多目标优化与帕累托前沿</h4>
<p><strong>16.3 加权和方法</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：成本 vs 排放 双目标

Cost &#x3D; ...;   % 经济性目标
Emission &#x3D; ...; % 环境目标

% 加权和
weights &#x3D; linspace(0,1,11);  % 11个权重组合
pareto_front &#x3D; zeros(2,length(weights));

for i &#x3D; 1:length(weights)
    Objective &#x3D; weights(i)*Cost + (1-weights(i))*Emission;
    optimize(Constraints, Objective, ops);
    
    pareto_front(1,i) &#x3D; value(Cost);
    pareto_front(2,i) &#x3D; value(Emission);
end

% 绘制帕累托前沿
plot(pareto_front(1,:), pareto_front(2,:), &#39;-o&#39;);
xlabel(&#39;成本&#39;);
ylabel(&#39;排放&#39;);
title(&#39;帕累托前沿&#39;);
grid on;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>16.4 epsilon约束法</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 更精确的方法：epsilon约束

cost_target &#x3D; linspace(min_cost, max_cost, 20);
emission_min &#x3D; zeros(size(cost_target));

for i &#x3D; 1:length(cost_target)
    Constraints_epsilon &#x3D; [Constraints, Cost &lt;&#x3D; cost_target(i)];
    optimize(Constraints_epsilon, Emission, ops);
    emission_min(i) &#x3D; value(Emission);
end

plot(cost_target, emission_min, &#39;-x&#39;);
xlabel(&#39;成本上限&#39;);
ylabel(&#39;最小排放&#39;);
title(&#39;epsilon约束法帕累托前沿&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="第17天工业界最佳实践">0.5.3. 第17天：工业界最佳实践</h3>
<h4 id="上午3小时代码工程化">0.5.3.1. 上午（3小时）：代码工程化</h4>
<p><strong>17.1 函数封装与模块化</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 规范的优化项目结构

% 项目文件夹结构：
% microgrid_project&#x2F;
%   ├── main.m                    % 主脚本
%   ├── data&#x2F;
%   │   ├── case30.mat           % 系统数据
%   │   └── load_forecast.csv    % 负荷预测
%   ├── src&#x2F;
%   │   ├── build_model.m        % 模型构建
%   │   ├── solve_model.m        % 求解器调用
%   │   ├── post_process.m       % 后处理
%   │   └── visual_results.m     % 可视化
%   └── results&#x2F;
%       ├── figures&#x2F;
%       └── logs&#x2F;

%%% build_model.m 示例
function [Constraints, Objective, vars] &#x3D; build_model(system_data, params)
% 构建微电网调度模型
% 输入：
%   system_data - 系统数据结构体
%   params - 参数结构体
% 输出：
%   Constraints - 约束集合
%   Objective - 目标函数
%   vars - 变量结构体

% 解包数据
n_gen &#x3D; system_data.n_gen;
n_hour &#x3D; params.n_hour;

% 定义变量
vars.P_gen &#x3D; sdpvar(n_gen, n_hour);
vars.u_on &#x3D; binvar(n_gen, n_hour);

% 构建约束（此处简化，实际更复杂）
Constraints &#x3D; [];
Constraints &#x3D; [Constraints, vars.P_gen &gt;&#x3D; 0];
Constraints &#x3D; [Constraints, vars.P_gen &lt;&#x3D; system_data.P_max*vars.u_on];

% 目标函数
cost_coeff &#x3D; system_data.cost_coeff;
Objective &#x3D; sum(sum(cost_coeff(1)*vars.P_gen.^2 + ...
                    cost_coeff(2)*vars.P_gen + ...
                    cost_coeff(3)*vars.u_on));

end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>17.2 错误处理与日志系统</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%%% solve_model.m 示例（工业级错误处理）
function [result, vars_opt] &#x3D; solve_model(Constraints, Objective, vars, ops)
% 求解模型并处理错误

% 创建日志文件
log_file &#x3D; sprintf(&#39;solver_log_%s.txt&#39;, datestr(now,&#39;yyyymmdd_HHMMSS&#39;));
diary(log_file);

try
    % 求解
    result &#x3D; optimize(Constraints, Objective, ops);
    
    % 检查求解状态
    switch result.problem
        case 0
            fprintf(&#39;求解成功！\n&#39;);
            % 提取结果
            vars_opt &#x3D; extract_results(vars);
        case 1
            warning(&#39;模型无可行解&#39;);
            vars_opt &#x3D; [];
            % 调用冲突分析
            conflict_analysis(Constraints);
        case 2
            warning(&#39;模型无界&#39;);
            vars_opt &#x3D; [];
        otherwise
            error(&#39;求解失败，错误代码: %d&#39;, result.problem);
    end
    
catch ME
    % 捕获异常
    fprintf(&#39;求解过程中发生异常: %s\n&#39;, ME.message);
    vars_opt &#x3D; [];
    result.problem &#x3D; -1;
end

diary off;
end

%%% 辅助函数
function vars_opt &#x3D; extract_results(vars)
% 递归提取所有变量的值
fields &#x3D; fieldnames(vars);
for i &#x3D; 1:length(fields)
    field &#x3D; fields&#123;i&#125;;
    if isa(vars.(field), &#39;sdpvar&#39;)
        vars_opt.(field) &#x3D; value(vars.(field));
    elseif isstruct(vars.(field))
        vars_opt.(field) &#x3D; extract_results(vars.(field));
    end
end
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="下午3小时性能优化与并行计算">0.5.3.2. 下午（3小时）：性能优化与并行计算</h4>
<p><strong>17.3 YALMIP + Parallel Computing Toolbox</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 场景：多场景并行优化（场景间独立）

% 创建并行池
parpool(8);  % 启动8个worker

% 定义场景
scenarios &#x3D; 1:50;

% 并行求解
results &#x3D; parallel_fcn(@solve_single_scenario, scenarios);

% 关闭并行池
delete(gcp);

%%% 辅助函数
function result &#x3D; solve_single_scenario(scenario_id)
% 每个worker独立求解一个场景

% 加载场景数据
load([&#39;scenario_&#39;,num2str(scenario_id),&#39;.mat&#39;]);

% 构建并求解模型（与主程序隔离）
Constraints &#x3D; ...;
Objective &#x3D; ...;
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.OutputFlag&#39;,0);  % 抑制输出

result &#x3D; optimize(Constraints, Objective, ops);
end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>17.4 Gurobi分布式优化（Tuning Tool）</strong></p>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 使用Gurobi Tuning Tool自动调参

% 保存模型
savemodel(Constraints, Objective, &#39;model.mps&#39;);

% 调用gurobi调参工具
% 命令行：gurobi_cl TuneTimeLimit&#x3D;3600 TuneCriterion&#x3D;2 model.mps
% 在MATLAB中：
system(&#39;gurobi_cl TuneTimeLimit&#x3D;3600 TuneCriterion&#x3D;2 model.mps&#39;);

% 调参后生成.prm文件，加载使用
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.Params&#39;,&#39;tuned.prm&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="附录学习资源与工具链">0.6. 附录：学习资源与工具链</h2>
<h3 id="a-1-必备资源清单">0.6.1. A-1 必备资源清单</h3>
<pre class="line-numbers language-none"><code class="language-none">【软件安装】
- MATLAB R2024b（官网：mathworks.com）
- Gurobi 11.0（官网：gurobi.com，学术许可证免费）
- YALMIP（GitHub：yalmip&#x2F;yalmip）

【文档教程】
- YALMIP Wiki：yalmip.github.io（最好的教材，所有函数说明）
- Gurobi Documentation：www.gurobi.com&#x2F;documentation（参数详解）
- MATLAB Optimization Toolbox：mathworks.com&#x2F;help&#x2F;optim&#x2F;

【书籍推荐】
- 《Convex Optimization》（Boyd &amp; Vandenberghe）- 理论基石
- 《Optimization in Engineering》（Kirby）- 工程应用
- 《Model Predictive Control》（Rawlings &amp; Mayne）- MPC圣经

【在线课程】
- Coursera: Discrete Optimization（含MILP）
- edX: Optimization Methods for Business Analytics
- B站：搜索&quot;YALMIP教程&quot;（有中文视频）

【论文复现】
- 电力系统：《Unit commitment in electric power systems》（Wood &amp; Wollenberg）
- 路径规划：《A survey on the vehicle routing problem》
- MPC：《Model predictive control: theory and practice》

【社区支持】
- Stack Overflow: 标签[yalmip], [gurobi]
- YALMIP Google Groups: 提问和查看历史问题
- GitHub Issues: 报告bug和请求功能<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="a-2-自测题与答案">0.6.2. A-2 自测题与答案</h3>
<pre class="line-numbers language-matlab" data-language="matlab"><code class="language-matlab">%% 自测题1：判断模型类型
% 根据以下目标函数和约束，判断问题类型（LP&#x2F;MILP&#x2F;QP&#x2F;QCP）

% (1) 
% minimize x1 + 2*x2
% s.t. x1 + x2 &gt;&#x3D; 5
%      x1, x2 &gt;&#x3D; 0
% 答案：LP（线性目标，线性约束，连续变量）

% (2)
% minimize x1^2 + x2^2
% s.t. x1 + x2 &gt;&#x3D; 5
%      x1, x2 ∈ &#123;0,1&#125;
% 答案：非凸QP（二元变量+二次目标）→ Gurobi可处理但可能慢

% (3)
% minimize x1 + y1
% s.t. x1 + 2*y1 &gt;&#x3D; 3
%      x1 &gt;&#x3D; 0, y1 ∈ &#123;0,1&#125;
% 答案：MILP（线性混合整数）

% (4)
% minimize x1&#39;*Q*x1 + c&#39;*x1 + y1&#39;*d
% s.t. ||x1||_2 &lt;&#x3D; 10
%      y1 ∈ &#123;0,1&#125;
% 答案：MIQCP（混合整数二次约束）

%% 自测题2：代码纠错
% 以下代码有3处错误，请找出并修正

x &#x3D; sdpvar(5,1);
y &#x3D; binvar(5,1);
Constraints &#x3D; [];
for i &#x3D; 1:5
    Constraints &#x3D; [x(i) + y(i) &lt;&#x3D; 10];  % 错误1：覆盖而非追加
end
obj &#x3D; sum(x.^2 + y);
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;MIPGap&#39;,0.01);  % 错误2：参数名
optimize(Constraints, obj, ops);
disp(&#39;最优值:&#39;, value(obj));  % 错误3：语法

% 修正后：
x &#x3D; sdpvar(5,1);
y &#x3D; binvar(5,1);
Constraints &#x3D; [];
for i &#x3D; 1:5
    Constraints &#x3D; [Constraints, x(i) + y(i) &lt;&#x3D; 10];  % 追加
end
obj &#x3D; sum(x.^2 + y);
ops &#x3D; sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;,&#39;gurobi.MIPGap&#39;,0.01);  % 加前缀
result &#x3D; optimize(Constraints, obj, ops);
if result.problem &#x3D;&#x3D; 0
    fprintf(&#39;最优值: %.4f\n&#39;, value(obj));  % 正确语法
end

%% 自测题3：建模练习
% 建模问题：仓库选址，最小化建设+运输成本
% 数据：
%  - 5个候选仓库位置，建设成本[100,150,120,90,110]万元
%  - 10个客户，需求量[30,20,15,25,18,22,30,12,28,35]吨
%  - 运输成本：距离(km)×0.5元&#x2F;吨km
% 要求：写出完整MATLAB代码

% 答案框架：
clear;
% 数据
build_cost &#x3D; [100,150,120,90,110];
demand &#x3D; [30,20,15,25,18,22,30,12,28,35];
distance &#x3D; rand(5,10)*50;  % 随机生成距离
transport_rate &#x3D; 0.5;

% 变量
y &#x3D; binvar(5,1);  % 选址
x &#x3D; sdpvar(5,10); % 运输量

% 约束
C &#x3D; [];
C &#x3D; [C, sum(x,2) &lt;&#x3D; 1000*y];  % 只有建的仓库才能供应
C &#x3D; [C, sum(x,1)&#39; &#x3D;&#x3D; demand]; % 满足需求
C &#x3D; [C, x &gt;&#x3D; 0];

% 目标
Build_Cost &#x3D; build_cost&#39;*y;
Transport_Cost &#x3D; sum(sum(distance*transport_rate.*x));
Objective &#x3D; Build_Cost + Transport_Cost;

% 求解
optimize(C, Objective, sdpsettings(&#39;solver&#39;,&#39;gurobi&#39;));
disp(value(Objective));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="结语从入门到精通">0.7. 结语：从入门到精通</h2>
<p>恭喜你完成了这个万字学习路线图！回顾四周的学习：</p>
<ul>
<li><strong>第1周</strong>：环境搭建 + LP/MILP/QP基础 →
<strong>掌握YALMIP语法</strong></li>
<li><strong>第2周</strong>：经典模型实战 →
<strong>理解建模思维</strong></li>
<li><strong>第3周</strong>：参数调优 + 调试技巧 →
<strong>解决实际问题</strong></li>
<li><strong>第4周</strong>：综合项目 + 避坑指南 →
<strong>具备独立项目能力</strong></li>
</ul>
<p><strong>下一步建议：</strong></p>
<ol type="1">
<li><strong>立即行动</strong>：明天就开始第1天的环境安装，不要拖延</li>
<li><strong>项目驱动</strong>：结合你的研究方向，1个月内完成一个真实项目</li>
<li><strong>代码复用</strong>：保存所有写过的代码，建立个人函数库</li>
<li><strong>持续学习</strong>：关注YALMIP
GitHub更新，每年Gurobi新版本都有性能提升</li>
<li><strong>社区贡献</strong>：在Stack
Overflow回答YALMIP问题，教学相长</li>
</ol>
<p><strong>记住：优化建模是艺术 +
科学的结合。多练习、多调试、多总结，你很快就能成为团队中的”优化专家”！</strong></p>
<p>祝学习顺利！</p>
<hr>
<p><strong>文档信息：</strong> - 版本：v2.5（2025年12月更新） -
作者：基于YALMIP官方文档与工业实践整理 - 许可证：CC BY-NC-SA
4.0（非商业用途可自由分享）</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">小白菜</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://c3f15f6.github.io/2025/12/21/%E7%A0%940/operation/learn_trace/k2/">https://c3f15f6.github.io/2025/12/21/%E7%A0%940/operation/learn_trace/k2/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">小白菜</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    
        <style>
    .valine-card {
        margin: 1.5rem auto;
    }

    .valine-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #vcomments textarea {
        box-sizing: border-box;
        background: url("/medias/comment_bg.png") 100% 100% no-repeat;
    }

    #vcomments p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }

    #vcomments blockquote p {
        text-indent: 0.2rem;
    }

    #vcomments a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }

    #vcomments img {
        max-width: 100%;
        height: auto;
        cursor: pointer;
    }

    #vcomments ol li {
        list-style-type: decimal;
    }

    #vcomments ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }

    #vcomments ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }

    #vcomments ul li {
        list-style-type: disc;
    }

    #vcomments ul ul li {
        list-style-type: circle;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    #vcomments table, th, td {
        border: 0;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }

    #vcomments h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }

    #vcomments h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }

    #vcomments h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    #vcomments h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }

    #vcomments h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }

    #vcomments p {
        font-size: 1rem;
        line-height: 1.5rem;
    }

    #vcomments hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }

    #vcomments blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }

    #vcomments pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }

    #vcomments code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }

    #vcomments pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }

    #vcomments pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }

    #vcomments code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }

    #vcomments b,
    strong {
        font-weight: bold;
    }

    #vcomments dfn {
        font-style: italic;
    }

    #vcomments small {
        font-size: 85%;
    }

    #vcomments cite {
        font-style: normal;
    }

    #vcomments mark {
        background-color: #fcf8e3;
        padding: .2em;
    }

    #vcomments table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }

    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }

    #vcomments table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }

    #vcomments table td {
        min-width: 80px;
    }

    #vcomments [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
</style>

<div class="card valine-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="vcomments" class="card-content" style="display: grid">
    </div>
</div>

<script src="/libs/valine/av-min.js"></script>
<script src="/libs/valine/Valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        appId: 'ypIvvy9QRua2Q0ztdf0tgeBp-gzGzoHsz',
        appKey: '9nVDPQd67XNMLKXa2xogMJMm',
        serverURLs: 'https://ypivvy9q.lc-cn-n1-shared.com',
        notify: 'false' === 'true',
        verify: 'false' === 'true',
        visitor: 'true' === 'true',
        avatar: 'mm',
        pageSize: '10',
        lang: 'zh-cn',
        placeholder: 'just go go'
    });
</script>

<!--酷Q推送-->


    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2025/12/21/%E7%A0%940/operation/matlab/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="matlab">
                        
                        <span class="card-title">matlab</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-12-21
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/optimization/" class="post-category">
                                    optimization
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/12/01/%E7%A0%940/operation/OR_intruction/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="OR 导论">
                        
                        <span class="card-title">OR 导论</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-12-01
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/optimization/" class="post-category">
                                    optimization
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%BF%90%E7%AD%B9/">
                        <span class="chip bg-color">运筹</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 汤汁小白菜<br />'
            + '文章作者: 小白菜<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('1'),
            headingSelector: 'h1, h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="149297"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.4'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2024-2026</span>
            
            <a href="/about" target="_blank">小白菜</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">76.4k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/c3f15f6" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:c3y15f6@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3114429249" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3114429249" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
